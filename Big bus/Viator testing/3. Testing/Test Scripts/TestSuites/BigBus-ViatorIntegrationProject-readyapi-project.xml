<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project id="e83cc60f-3e1a-4e46-927e-65e067025a8a" created="2.2.0" activeEnvironment="Default" name="BigBus_ViatorIntegrationProject" resourceRoot="" updated="2.5.0 2018-09-14T14:45:07Z" abortOnError="false" runType="SEQUENTIAL" soapui-version="5.4.0" encryptionMode="Not encrypted" xmlns:con="http://eviware.com/soapui/config">
  <con:settings/>
  <con:interface xsi:type="con:RestService" id="db217857-7e33-4e4d-a9aa-b72e8179956a" wadlVersion="http://wadl.dev.java.net/2009/02" name="http://bb-viator-api-v.eu.cloudhub.io" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:settings/>
    <con:definitionCache type="TEXT" rootPart=""/>
    <con:endpoints>
      <con:endpoint>http://bb-viator-api-t.eu.cloudhub.io</con:endpoint>
      <con:endpoint>https://bb-viator-api-d.eu.cloudhub.io</con:endpoint>
    </con:endpoints>
    <con:resource name="TourList" path="/api/1/products" id="f5948cbd-2603-40ca-baa0-70035eaa3c64">
      <con:settings/>
      <con:parameters/>
      <con:method name="TourList" id="22458dc8-5d92-4d1e-bab0-e2fc29644fbd" method="POST">
        <con:settings/>
        <con:parameters/>
        <con:representation type="REQUEST">
          <con:mediaType>application/json</con:mediaType>
          <con:params/>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>application/json;charset=UTF-8</con:mediaType>
          <con:status>200</con:status>
          <con:params/>
          <con:element xmlns:prod="http://bb-viator-api-v.eu.cloudhub.io/api/products">prod:Response</con:element>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType>application/json</con:mediaType>
          <con:status>400 500 405 422 404</con:status>
          <con:params/>
          <con:element xmlns:prod="http://bb-viator-api-v.eu.cloudhub.io/api/products">prod:Fault</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType>text/html</con:mediaType>
          <con:status>405 502</con:status>
          <con:params/>
          <con:element>html</con:element>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType xsi:nil="true"/>
          <con:status>405 404</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType>application/json; charset=UTF-8</con:mediaType>
          <con:status>422 405</con:status>
          <con:params/>
          <con:element xmlns:prod="http://bb-viator-api-v.eu.cloudhub.io/api/products">prod:Fault</con:element>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType>application/json;charset=UTF-8</con:mediaType>
          <con:status>409</con:status>
          <con:params/>
          <con:element xmlns:prod="http://bb-viator-api-v.eu.cloudhub.io/api/1/products">prod:Fault</con:element>
        </con:representation>
        <con:request name="Request 1" id="398b8177-7e96-4821-b532-20216c36ac53" mediaType="application/json" postQueryString="false">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="Basic MjliZmFlZTItZmE2Ni00ZGE2LTk2NDItMmNkYzYyZDU2Y2MwOjhiXmdmPWxiczVBU0E0VlptSDJOemdETVNeJHNASGdCRmVJY08xelk9b2k=" xmlns="http://eviware.com/soapui/config"/></con:setting>
          </con:settings>
          <con:endpoint>https://bb-viator-api-d.eu.cloudhub.io</con:endpoint>
          <con:request>{
 "requestType": "TourListRequest",
 "data": {
   "ApiKey": "0FGb?42VKs9hCuZZH*Ttm#RtH_OPKAF7zEBNL8ZRvOE",
   "ResellerId": "1000",
   "SupplierId": "1004",
   "ExternalReference": "10051374722994001",
   "Timestamp": "2019-01-21 18:20:49",
   "Extension": {
     "any": {}
   },
   "Parameter": [
     {
       "Name": "TourGradeLevelAvailability",
       "Value": "True"
     }
   ]
 }
}</con:request>
          <con:originalUri>http://bb-viator-api-v.eu.cloudhub.io/api/products</con:originalUri>
          <con:credentials>
            <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:parameters/>
        </con:request>
      </con:method>
    </con:resource>
    <con:resource name="Availability" path="/api/1/products/availability" id="2abc02b1-2e63-4782-af97-93ee57987a41">
      <con:settings/>
      <con:parameters/>
      <con:method name="Availability" id="59072dc2-41c5-49d0-a2f9-ae59ef33994d" method="POST">
        <con:settings/>
        <con:parameters/>
        <con:representation type="REQUEST">
          <con:mediaType>application/json</con:mediaType>
          <con:params/>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType>text/html</con:mediaType>
          <con:status>405</con:status>
          <con:params/>
          <con:element>html</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>application/json;charset=UTF-8</con:mediaType>
          <con:status>200</con:status>
          <con:params/>
          <con:element xmlns:ava="https://bb-viator-trade-api-d.eu.cloudhub.io/api/1/products/availability">ava:Response</con:element>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType>application/json</con:mediaType>
          <con:status>422 500 421 400 404</con:status>
          <con:params/>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType>application/json; charset=UTF-8</con:mediaType>
          <con:status>422 405</con:status>
          <con:params/>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType>application/json;charset=UTF-8</con:mediaType>
          <con:status>409</con:status>
          <con:params/>
          <con:element xmlns:ava="https://bb-viator-trade-api-d.eu.cloudhub.io/api/1/products/availability">ava:Fault</con:element>
        </con:representation>
        <con:request name="Request 1" id="e75a73a0-c942-4734-86bf-456c8ef713c6" mediaType="application/json" postQueryString="false">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Authorization" value="Basic MjliZmFlZTItZmE2Ni00ZGE2LTk2NDItMmNkYzYyZDU2Y2MwOjhiXmdmPWxiczVBU0E0VlptSDJOemdETVNeJHNASGdCRmVJY08xelk9b2k=" xmlns="http://eviware.com/soapui/config"/></con:setting>
          </con:settings>
          <con:endpoint>https://bb-viator-api-d.eu.cloudhub.io</con:endpoint>
          <con:request>{
 "requestType": "AvailabilityRequest",
 "data": {
   "ApiKey": "0FGb?42VKs9hCuZZH*Ttm#RtH_OPKAF7zEBNL8ZRvOE",
   "ResellerId": "1000",
   "SupplierId": "1004",
   "ExternalReference": "10051374722992616",
   "Timestamp": "2019-03-21 18:34:24",
   "StartDate": "2019-12-21",
   "EndDate": "2019-12-22",
   "DeltaOnly": false,
   "SupplierProductCode": "54493",
   "TourOptions": {
     "SupplierOptionCode": "9am",
     "SupplierOptionName": "Bondi Beach Private Lesson 9AM",
     "TourDepartureTime": "09:00:00",
     "TourDuration": "PT1H",
     "Language": {
       "LanguageCode": "EN",
       "LanguageOption": "GUIDE"
     }
   },
   "AvailabilityHold": {
     "Expiry": "PT300S"
   },
   "TravellerMix": {
     "Adult": "1",
     "Child": "1",
     "Youth": "0",
     "Infant": "0",
     "Senior": "0",
     "Total": "2"
   },
   "Parameter": [
     {
       "Name": "TourGradeLevelAvailability",
       "Value": "True"
     }
   ]
 }
}</con:request>
          <con:originalUri>https://bb-viator-trade-api-d.eu.cloudhub.io/api/1/products/availability</con:originalUri>
          <con:credentials>
            <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:parameters/>
          <con:parameterOrder/>
        </con:request>
      </con:method>
    </con:resource>
    <con:resource name="Booking" path="/api/1/bookings" id="566f3e8f-b41f-406a-b46e-f9e9df95e4c9">
      <con:settings/>
      <con:parameters/>
      <con:method name="Booking" id="bda8b209-f194-4a4b-a48c-534a1bd1b4d3" method="POST">
        <con:settings/>
        <con:parameters/>
        <con:representation type="REQUEST">
          <con:mediaType>application/json</con:mediaType>
          <con:params/>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType>text/html</con:mediaType>
          <con:status>405</con:status>
          <con:params/>
          <con:element>html</con:element>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType>application/json</con:mediaType>
          <con:status>500 400 405 422 404</con:status>
          <con:params/>
          <con:element xmlns:book="https://bb-viator-trade-api-d.eu.cloudhub.io/api/1/bookings">book:Fault</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>application/json;charset=UTF-8</con:mediaType>
          <con:status>200</con:status>
          <con:params/>
          <con:element xmlns:book="https://bb-viator-trade-api-d.eu.cloudhub.io/api/1/bookings">book:Response</con:element>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType>application/json;charset=UTF-8</con:mediaType>
          <con:status>500 409</con:status>
          <con:params/>
          <con:element xmlns:book="https://bb-viator-trade-api-d.eu.cloudhub.io/api/1/bookings">book:Fault</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType xsi:nil="true"/>
          <con:status>404</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType>application/json; charset=UTF-8</con:mediaType>
          <con:status>422 405</con:status>
          <con:params/>
        </con:representation>
        <con:request name="Request 1" id="81f6f042-63a0-4c5a-a262-f0e015d8cf14" mediaType="application/json" postQueryString="false">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            <con:setting id="RecordRequestRepresentations">true</con:setting>
          </con:settings>
          <con:endpoint>https://bb-viator-api-d.eu.cloudhub.io</con:endpoint>
          <con:request>{
 "requestType": "BookingRequest",
 "data": {
   "ApiKey": "0FGb?42VKs9hCuZZH*Ttm#RtH_OPKAF7zEBNL8ZRvOE",
   "ResellerId": "1000",
   "SupplierId": "2000145",
   "ExternalReference": "10051374722992616",
   "Timestamp": "2018-03-07T12:35:47.214-08:00",
   "BookingReference": "645394587",
   "TravelDate": "2019-12-20",
   "SupplierProductCode": "194595",
   "Location": "London",
   "TourOptions": {
     "Language": {
       "LanguageCode": "en",
       "LanguageOption": [
         "GUIDE"
       ]
     }
   },
   "Inclusions": {
     "Inclusion": [
       "Hop-on hop-off bus tour",
       "Live guide (Red Route)",
       "Recorded commentary",
       "Complimentary earphones",
       "30-minute river cruise",
       "A walking tour",
       "Reward Voucher booklet",
       "Hotel drop-off"
     ]
   },
   "CurrencyCode": "GBP",
   "Amount": 77.22,
   "Traveller": [
     {
       "TravellerIdentifier": "1",
       "TravellerTitle": "",
       "GivenName": "Michael",
       "Surname": "Matusik",
       "AgeBand": "ADULT",
       "LeadTraveller": true
     },
     {
       "TravellerIdentifier": "2",
       "TravellerTitle": "",
       "GivenName": "Michael",
       "Surname": "Matusik",
       "AgeBand": "ADULT",
       "LeadTraveller": false
     },
     {
       "TravellerIdentifier": "3",
       "TravellerTitle": "",
       "GivenName": "Michael",
       "Surname": "Matusik",
       "AgeBand": "ADULT",
       "LeadTraveller": false
     }
   ],
   "TravellerMix": {
     "Adult": "3",
     "Child": "0",
     "Youth": "0",
     "Infant": "0",
     "Senior": "0",
     "Total": "3"
   },
   "Parameter": [
     {
       "Name": "TourGradeLevelAvailability",
       "Value": "True"
     }
   ]
 }
}</con:request>
          <con:originalUri>https://bb-viator-trade-api-d.eu.cloudhub.io/api/1/bookings</con:originalUri>
          <con:credentials>
            <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:parameters/>
          <con:parameterOrder/>
        </con:request>
      </con:method>
    </con:resource>
    <con:resource name="Cancel Booking" path="/api/1/bookings/cancel" id="e2d74447-70a0-452d-ac1f-09f084233c28">
      <con:settings/>
      <con:parameters/>
      <con:method name="Cancel Booking" id="f48cf531-a0d4-44f6-9d40-17cd44c31521" method="POST">
        <con:settings/>
        <con:parameters/>
        <con:representation type="REQUEST">
          <con:mediaType>application/json</con:mediaType>
          <con:params/>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType>application/json;charset=UTF-8</con:mediaType>
          <con:status>200</con:status>
          <con:params/>
          <con:element xmlns:can="http://bb-viator-api-v.eu.cloudhub.io/api/bookings/cancel">can:Response</con:element>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType>application/json</con:mediaType>
          <con:status>400 422 404</con:status>
          <con:params/>
          <con:element xmlns:can="http://bb-viator-api-v.eu.cloudhub.io/api/bookings/cancel">can:Fault</con:element>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType>application/json;charset=UTF-8</con:mediaType>
          <con:status>400 500 409</con:status>
          <con:params/>
          <con:element xmlns:can="http://bb-viator-api-v.eu.cloudhub.io/api/bookings/cancel">can:Fault</con:element>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType xsi:nil="true"/>
          <con:status>404</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType>application/json; charset=UTF-8</con:mediaType>
          <con:status>422 405</con:status>
          <con:params/>
          <con:element xmlns:can="http://bb-viator-api-v.eu.cloudhub.io/api/bookings/cancel">can:Fault</con:element>
        </con:representation>
        <con:representation type="FAULT">
          <con:mediaType>text/html</con:mediaType>
          <con:status>405</con:status>
          <con:params/>
          <con:element>html</con:element>
        </con:representation>
        <con:representation type="RESPONSE">
          <con:mediaType xsi:nil="true"/>
          <con:status>0</con:status>
          <con:params/>
          <con:element>data</con:element>
        </con:representation>
        <con:request name="Request 1" id="f1d27481-754b-4c8a-ad27-48cd079691c4" mediaType="application/json" postQueryString="false">
          <con:settings>
            <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
          </con:settings>
          <con:endpoint>https://bb-viator-api-d.eu.cloudhub.io</con:endpoint>
          <con:request>{
"requestType": "BookingCancellationRequest",
"data": {
  "ApiKey": "0FGb?42VKs9hCuZZH*Ttm#RtH_OPKAF7zEBNL8ZRvOE",
  "ResellerId": "1000",
  "SupplierId": "1004",
  "ExternalReference": "10051374722992616",
  "Timestamp": "2019-01-21 17:49:40",
  "Extension": {
    "any": {}
  },
  "Parameter": [
    {
      "Name": "TourGradeLevelAvailability",
      "Value": "True"
    }
  ],
  "RequestStatus": {
    "Status": "SUCCESS"
  },
  "BookingReference": "332002200014548999731299852079166",
  "SupplierConfirmationNumber": "006cc2a5-9be7-4efc-af85-fb1d1965bd95",
  "CancelDate": "2019-12-01",
  "Author": "Customer Service",
  "Reason": "No longer traveling",
  "SupplierNote": "Refunded Customer"
}
}</con:request>
          <con:originalUri>http://bb-viator-api-v.eu.cloudhub.io/api/bookings/cancel</con:originalUri>
          <con:credentials>
            <con:selectedAuthProfile>No Authorization</con:selectedAuthProfile>
            <con:authType>No Authorization</con:authType>
          </con:credentials>
          <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
          <con:parameters/>
          <con:parameterOrder/>
        </con:request>
      </con:method>
    </con:resource>
  </con:interface>
  <con:testSuite id="374934a0-991a-4606-aa4b-593350503bb4" name="TourList_TestSuite">
    <con:settings/>
    <con:savedRecentRuns>1</con:savedRecentRuns>
    <con:runType>SEQUENTIAL</con:runType>
    <con:testCase id="7c472651-f61e-4425-a179-bc598d8abcb4" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TourList_BMO" searchProperties="true" timeout="0" maxResults="0">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="cc30570f-8b68-4053-999d-c3cac082afa6">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\TestData\BigBusViatorTouList_TestData.xlsx</con:value>
            </con:property>
            <con:property>
              <con:name>SaveLocation</con:name>
              <con:value>${projectDir}\TestResults\TourList\</con:value>
            </con:property>
            <con:property>
              <con:name>TestDataSheetName</con:name>
              <con:value>BMO</con:value>
            </con:property>
            <con:property>
              <con:name>Filename</con:name>
              <con:value>BigBusViatorTouList_TestData</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="8ef81958-bb5c-436b-8fb6-7899785cfe5a">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>${Properties#Source}</file>
              <worksheet>BMO</worksheet>
              <cell>A7</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Test Case</con:property>
          <con:property>Description (optional)</con:property>
          <con:property>requestType</con:property>
          <con:property>ApiKey</con:property>
          <con:property>ResellerId</con:property>
          <con:property>SupplierId</con:property>
          <con:property>ExternalReference</con:property>
          <con:property>Timestamp</con:property>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="cdced825-9e69-4342-bf32-912220caeea2">
        <con:settings/>
        <con:config service="http://bb-viator-api-v.eu.cloudhub.io" resourcePath="/api/1/products" methodName="TourList" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="398b8177-7e96-4821-b532-20216c36ac53" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>${#Project#endpoint}</con:endpoint>
            <con:request>{
  "requestType":"${DataSource#requestType}",
  "data":{
    "ApiKey":"${DataSource#ApiKey}",
    "ResellerId":"${DataSource#ResellerId}",
    "SupplierId":"${DataSource#SupplierId}",
    "ExternalReference":"${DataSource#ExternalReference}",
    "Timestamp":"${DataSource#Timestamp}"
    }
  }</con:request>
            <con:originalUri>http://bb-viator-api-v.eu.cloudhub.io/api/1/products</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>Inherit From Parent</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="transfer" name="Property Transfer" id="24bc3507-cf82-45b7-8ed0-562fe453c377">
        <con:settings/>
        <con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>responseType</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>responseType</con:sourcePath>
            <con:targetType>responseType</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>status</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.Status</con:sourcePath>
            <con:targetType>status</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:targetPath/>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>response</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath/>
            <con:targetType>response</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>failReason</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.ErrorMessage</con:sourcePath>
            <con:targetType>failReason</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="SaveXmls" id="0633f217-63a4-4a86-832e-cb21182d3117">
        <con:settings/>
        <con:config>
          <script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def name = context.expand( '${Properties#Filename}' )
def location = context.expand( '${Properties#SaveLocation}' )
log.info(location)
def getResponseFilename(name) {
   count = ( testRunner.testCase.testSteps["DataSource"].currentRow )
   date = new Date()
   dateFormat = new java.text.SimpleDateFormat('yyyyMMdd-kkmmss')
   shortDate = dateFormat.format(date)
def testCaseID = context.expand( '${DataSource#Test Case}' )
   respFilename = shortDate + "-" + testCaseID + "-response.xml"  // implicitely returned
}

def getRequestFilename(name) {  
	def testCaseID = context.expand( '${DataSource#Test Case}' ) 
	reqFilename = shortDate + "-" + testCaseID + "-request.xml"  // implicitely returned
}
	
def file = new PrintWriter (location + getResponseFilename(name))
log.info(name)
def Response = testRunner.testCase.testSteps["Request"].testRequest.response.contentAsString
log.info(Response)
file.println(Response)
file.flush()
file.close()

def file2 = new PrintWriter (location + getRequestFilename(name))
def Request = context.expand( '${Request#Request}' )
file2.println(Request)
file2.flush()
file2.close()</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="f852589e-0641-449f-9670-6b633fa11e53">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorTouList_TestData.xlsx</file>
              <outfile>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorTouList_TestData.xlsx</outfile>
              <worksheet>Results</worksheet>
              <cell>A4</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Test Case</con:name>
              <con:value>${DataSource#Test Case}</con:value>
            </con:property>
            <con:property>
              <con:name>description</con:name>
              <con:value>${DataSource#Description (optional)}</con:value>
            </con:property>
            <con:property>
              <con:name>request</con:name>
              <con:value>${#TestSuite#requestType}</con:value>
            </con:property>
            <con:property>
              <con:name>Test Case Status</con:name>
              <con:value>${#Project#status}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail Reason</con:name>
              <con:value>${#Project#failReason}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${#Project#response}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="c5ec4e3b-8b2e-4156-a78c-c7f1e5df090d">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>Request</targetStep>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
    </con:testCase>
    <con:testCase id="fc38736b-d2f9-4f0b-8233-178ad7c316b0" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TourList_MO" searchProperties="true" timeout="0" maxResults="0">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="035b0f86-d04d-4ff7-9c15-75fdf8fc116f">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\TestData\BigBusViatorTouList_TestData.xlsx</con:value>
            </con:property>
            <con:property>
              <con:name>SaveLocation</con:name>
              <con:value>${projectDir}\TestResults\TourList\</con:value>
            </con:property>
            <con:property>
              <con:name>TestDataSheetName</con:name>
              <con:value>BMO</con:value>
            </con:property>
            <con:property>
              <con:name>Filename</con:name>
              <con:value>BigBusViatorTouList_TestData</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="1f288c8b-eafb-4238-9c7f-2e97f5eb80c8">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorTouList_TestData.xlsx</file>
              <worksheet>MO</worksheet>
              <cell>A7</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Test Case</con:property>
          <con:property>Description (optional)</con:property>
          <con:property>requestType</con:property>
          <con:property>ApiKey</con:property>
          <con:property>ResellerId</con:property>
          <con:property>SupplierId</con:property>
          <con:property>ExternalReference</con:property>
          <con:property>Timestamp</con:property>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="276e66eb-ce85-4b5b-a587-69f32dda147c">
        <con:settings/>
        <con:config service="http://bb-viator-api-v.eu.cloudhub.io" resourcePath="/api/1/products" methodName="TourList" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="398b8177-7e96-4821-b532-20216c36ac53" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>${#Project#endpoint}</con:endpoint>
            <con:request>{
  "requestType":"${DataSource#requestType}",
  "data":{
    "ApiKey":"${DataSource#ApiKey}",
    "ResellerId":"${DataSource#ResellerId}",
    "SupplierId":"${DataSource#SupplierId}",
    "ExternalReference":"${DataSource#ExternalReference}",
    "Timestamp":"${DataSource#Timestamp}"
    }
  }</con:request>
            <con:originalUri>http://bb-viator-api-v.eu.cloudhub.io/api/1/products</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>Inherit From Parent</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="transfer" name="Property Transfer" id="a66ceb9c-ba86-45d9-8107-f28d5445c339">
        <con:settings/>
        <con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>responseType</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>responseType</con:sourcePath>
            <con:targetType>responseType</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>status</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.Status</con:sourcePath>
            <con:targetType>status</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:targetPath/>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>response</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath/>
            <con:targetType>response</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>failReason</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.ErrorMessage</con:sourcePath>
            <con:targetType>failReason</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="SaveXmls" id="e02f18dc-f44a-426b-b77d-6f7e0ac5e207">
        <con:settings/>
        <con:config>
          <script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def name = context.expand( '${Properties#Filename}' )
def location = context.expand( '${Properties#SaveLocation}' )
log.info(location)
def getResponseFilename(name) {
   count = ( testRunner.testCase.testSteps["DataSource"].currentRow )
   date = new Date()
   dateFormat = new java.text.SimpleDateFormat('yyyyMMdd-kkmmss')
   shortDate = dateFormat.format(date)
def testCaseID = context.expand( '${DataSource#Test Case}' )
   respFilename = shortDate + "-" + testCaseID + "-response.xml"  // implicitely returned
}

def getRequestFilename(name) {  
	def testCaseID = context.expand( '${DataSource#Test Case}' ) 
	reqFilename = shortDate + "-" + testCaseID + "-request.xml"  // implicitely returned
}
	
def file = new PrintWriter (location + getResponseFilename(name))
log.info(name)
def Response = testRunner.testCase.testSteps["Request"].testRequest.response.contentAsString
log.info(Response)
file.println(Response)
file.flush()
file.close()

def file2 = new PrintWriter (location + getRequestFilename(name))
def Request = context.expand( '${Request#Request}' )
file2.println(Request)
file2.flush()
file2.close()</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="ebcefe62-e849-4a94-b37d-ce62001f2032">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorTouList_TestData.xlsx</file>
              <outfile>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorTouList_TestData.xlsx</outfile>
              <worksheet>Results</worksheet>
              <cell>A12</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Test Case</con:name>
              <con:value>${DataSource#Test Case}</con:value>
            </con:property>
            <con:property>
              <con:name>description</con:name>
              <con:value>${DataSource#Description (optional)}</con:value>
            </con:property>
            <con:property>
              <con:name>request</con:name>
              <con:value>${#TestSuite#requestType}</con:value>
            </con:property>
            <con:property>
              <con:name>Test Case Status</con:name>
              <con:value>${#Project#status}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail Reason</con:name>
              <con:value>${#Project#failReason}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${#Project#response}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="d1224107-8d6a-4555-b49c-4f1f133095b3">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>Request</targetStep>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
    </con:testCase>
    <con:testCase id="012f5bea-9011-44b5-ae2d-e75e96a17511" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TourList_MM" searchProperties="true" timeout="0" maxResults="0">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="c31a76f3-eda6-4f84-838a-03b736e43363">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\TestData\BigBusViatorTouList_TestData.xlsx</con:value>
            </con:property>
            <con:property>
              <con:name>SaveLocation</con:name>
              <con:value>${projectDir}\TestResults\TourList\</con:value>
            </con:property>
            <con:property>
              <con:name>TestDataSheetName</con:name>
              <con:value>BMO</con:value>
            </con:property>
            <con:property>
              <con:name>Filename</con:name>
              <con:value>BigBusViatorTouList_TestData</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="c3c7b5fc-8317-426f-a5fd-23e4f6dad00f">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorTouList_TestData.xlsx</file>
              <worksheet>MM</worksheet>
              <cell>A7</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Test Case</con:property>
          <con:property>Description (optional)</con:property>
          <con:property>requestType</con:property>
          <con:property>ApiKey</con:property>
          <con:property>ResellerId</con:property>
          <con:property>SupplierId</con:property>
          <con:property>ExternalReference</con:property>
          <con:property>Timestamp</con:property>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="614eaad4-9608-4358-9957-0f48d1112be5">
        <con:settings/>
        <con:config service="http://bb-viator-api-v.eu.cloudhub.io" resourcePath="/api/1/products" methodName="TourList" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="398b8177-7e96-4821-b532-20216c36ac53" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>${#Project#endpoint}</con:endpoint>
            <con:request>{
  "requestType":"${DataSource#requestType}",
  "data":{
    "ApiKey":"${DataSource#ApiKey}",
    "ResellerId":"${DataSource#ResellerId}",
    "SupplierId":"${DataSource#SupplierId}",
    "ExternalReference":"${DataSource#ExternalReference}",
    "Timestamp":"${DataSource#Timestamp}"
    }
  }</con:request>
            <con:originalUri>http://bb-viator-api-v.eu.cloudhub.io/api/1/products</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>Inherit From Parent</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="transfer" name="Property Transfer" id="9bb86468-37d6-4c60-b977-76787ab8645d">
        <con:settings/>
        <con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>responseType</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>responseType</con:sourcePath>
            <con:targetType>responseType</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>status</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.Status</con:sourcePath>
            <con:targetType>status</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:targetPath/>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>response</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath/>
            <con:targetType>response</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>failreason</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.ErrorMessage</con:sourcePath>
            <con:targetType>failReason</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="SaveXmls" id="e24456fa-6b69-4ea6-999e-37ad9ba66703">
        <con:settings/>
        <con:config>
          <script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def name = context.expand( '${Properties#Filename}' )
def location = context.expand( '${Properties#SaveLocation}' )
log.info(location)
def getResponseFilename(name) {
   count = ( testRunner.testCase.testSteps["DataSource"].currentRow )
   date = new Date()
   dateFormat = new java.text.SimpleDateFormat('yyyyMMdd-kkmmss')
   shortDate = dateFormat.format(date)
def testCaseID = context.expand( '${DataSource#Test Case}' )
   respFilename = shortDate + "-" + testCaseID + "-response.xml"  // implicitely returned
}

def getRequestFilename(name) {  
	def testCaseID = context.expand( '${DataSource#Test Case}' ) 
	reqFilename = shortDate + "-" + testCaseID + "-request.xml"  // implicitely returned
}
	
def file = new PrintWriter (location + getResponseFilename(name))
log.info(name)
def Response = testRunner.testCase.testSteps["Request"].testRequest.response.contentAsString
log.info(Response)
file.println(Response)
file.flush()
file.close()

def file2 = new PrintWriter (location + getRequestFilename(name))
def Request = context.expand( '${Request#Request}' )
file2.println(Request)
file2.flush()
file2.close()</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="3bef4919-9c7e-4fef-94a5-d5b474ee38e0">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorTouList_TestData.xlsx</file>
              <outfile>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorTouList_TestData.xlsx</outfile>
              <worksheet>Results</worksheet>
              <cell>A6</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Test Case</con:name>
              <con:value>${DataSource#Test Case}</con:value>
            </con:property>
            <con:property>
              <con:name>description</con:name>
              <con:value>${DataSource#Description (optional)}</con:value>
            </con:property>
            <con:property>
              <con:name>request</con:name>
              <con:value>${#TestSuite#requestType}</con:value>
            </con:property>
            <con:property>
              <con:name>Test Case Status</con:name>
              <con:value>${#Project#status}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail Reason</con:name>
              <con:value>${#Project#failReason}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${#Project#response}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="2be894da-3d3e-4cdf-8a7e-c2f4708180d9">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>Request</targetStep>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
    </con:testCase>
    <con:testCase id="0beb410f-0cec-460c-bfb7-343813d349d1" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="TourList_ID" searchProperties="true" timeout="0" maxResults="0">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="344e495d-62ad-427a-9ea8-83cdef8de5d1">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\TestData\BigBusViatorTouList_TestData.xlsx</con:value>
            </con:property>
            <con:property>
              <con:name>SaveLocation</con:name>
              <con:value>${projectDir}\TestResults\TourList\</con:value>
            </con:property>
            <con:property>
              <con:name>TestDataSheetName</con:name>
              <con:value>BMO</con:value>
            </con:property>
            <con:property>
              <con:name>Filename</con:name>
              <con:value>BigBusViatorTouList_TestData</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="19b631b8-702c-4fd7-bbfe-246ee7f50fc1">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorTouList_TestData.xlsx</file>
              <worksheet>ID</worksheet>
              <cell>A7</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Test Case</con:property>
          <con:property>Description (optional)</con:property>
          <con:property>requestType</con:property>
          <con:property>ApiKey</con:property>
          <con:property>ResellerId</con:property>
          <con:property>SupplierId</con:property>
          <con:property>ExternalReference</con:property>
          <con:property>Timestamp</con:property>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="0c99aeec-efa1-44db-aa4d-892ea98998e1">
        <con:settings/>
        <con:config service="http://bb-viator-api-v.eu.cloudhub.io" resourcePath="/api/1/products" methodName="TourList" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="398b8177-7e96-4821-b532-20216c36ac53" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>${#Project#endpoint}</con:endpoint>
            <con:request>{
  "requestType":"${DataSource#requestType}",
  "data":{
    "ApiKey":"${DataSource#ApiKey}",
    "ResellerId":"${DataSource#ResellerId}",
    "SupplierId":"${DataSource#SupplierId}",
    "ExternalReference":"${DataSource#ExternalReference}",
    "Timestamp":"${DataSource#Timestamp}"
    }
  }</con:request>
            <con:originalUri>http://bb-viator-api-v.eu.cloudhub.io/api/1/products</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>Inherit From Parent</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="transfer" name="Property Transfer" id="5b989add-0ae2-4c45-ad43-5a378ae09026">
        <con:settings/>
        <con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>responseType</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>responseType</con:sourcePath>
            <con:targetType>responseType</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>status</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.Status[0]</con:sourcePath>
            <con:targetType>status</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:targetPath/>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>response</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath/>
            <con:targetType>response</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>failReason</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.ErrorMessage</con:sourcePath>
            <con:targetType>failReason</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="SaveXmls" id="1077cbe2-d8f4-495f-85aa-0d020991f7fa">
        <con:settings/>
        <con:config>
          <script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def name = context.expand( '${Properties#Filename}' )
def location = context.expand( '${Properties#SaveLocation}' )
log.info(location)
def getResponseFilename(name) {
   count = ( testRunner.testCase.testSteps["DataSource"].currentRow )
   date = new Date()
   dateFormat = new java.text.SimpleDateFormat('yyyyMMdd-kkmmss')
   shortDate = dateFormat.format(date)
def testCaseID = context.expand( '${DataSource#Test Case}' )
   respFilename = shortDate + "-" + testCaseID + "-response.xml"  // implicitely returned
}

def getRequestFilename(name) {  
	def testCaseID = context.expand( '${DataSource#Test Case}' ) 
	reqFilename = shortDate + "-" + testCaseID + "-request.xml"  // implicitely returned
}
	
def file = new PrintWriter (location + getResponseFilename(name))
log.info(name)
def Response = testRunner.testCase.testSteps["Request"].testRequest.response.contentAsString
log.info(Response)
file.println(Response)
file.flush()
file.close()

def file2 = new PrintWriter (location + getRequestFilename(name))
def Request = context.expand( '${Request#Request}' )
file2.println(Request)
file2.flush()
file2.close()</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="35fdf027-9baa-4889-be6f-bd853ea1276d">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorTouList_TestData.xlsx</file>
              <outfile>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorTouList_TestData.xlsx</outfile>
              <worksheet>Results</worksheet>
              <cell>A14</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Test Case</con:name>
              <con:value>${DataSource#Test Case}</con:value>
            </con:property>
            <con:property>
              <con:name>description</con:name>
              <con:value>${DataSource#Description (optional)}</con:value>
            </con:property>
            <con:property>
              <con:name>request</con:name>
              <con:value>${#TestSuite#requestType}</con:value>
            </con:property>
            <con:property>
              <con:name>Test Case Status</con:name>
              <con:value>${#Project#status}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail Reason</con:name>
              <con:value>${#Project#failReason}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${#Project#response}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="56d083e3-ef98-41c3-a426-5dfe3dd14e49">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>Request</targetStep>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
    </con:testCase>
    <con:properties>
      <con:property>
        <con:name>requestType</con:name>
        <con:value>TourListRequest</con:value>
      </con:property>
    </con:properties>
    <con:reportParameters/>
  </con:testSuite>
  <con:testSuite id="25dd953c-bda4-416d-aff2-acc878f6544f" name="Availability_TestSuite">
    <con:settings/>
    <con:savedRecentRuns>1</con:savedRecentRuns>
    <con:runType>SEQUENTIAL</con:runType>
    <con:testCase id="b8252d1f-8e80-4a07-9c0b-ed6dfcaa75ac" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="Availability_BMO" searchProperties="true" timeout="0" maxResults="0">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="33c0bb71-8fea-4fba-aaa1-b16245790407">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\TestData\BigBusViatorAvailability_TestData.xlsx</con:value>
            </con:property>
            <con:property>
              <con:name>SaveLocation</con:name>
              <con:value>${projectDir}\TestResults\Availability\</con:value>
            </con:property>
            <con:property>
              <con:name>TestDataSheetName</con:name>
              <con:value>BMO</con:value>
            </con:property>
            <con:property>
              <con:name>Filename</con:name>
              <con:value>BigBusViatorAvailability_TestData</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="3e41b0d4-aeab-47e4-b71d-a4b9a93a638d">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>${Properties#Source}</file>
              <worksheet>BMO</worksheet>
              <cell>A7</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Test Case</con:property>
          <con:property>Description (optional)</con:property>
          <con:property>requestType</con:property>
          <con:property>ApiKey</con:property>
          <con:property>ResellerId</con:property>
          <con:property>SupplierId</con:property>
          <con:property>ExternalReference</con:property>
          <con:property>Timestamp</con:property>
          <con:property>StartDate</con:property>
          <con:property>EndDate</con:property>
          <con:property>DeltaOnly</con:property>
          <con:property>DeltaSince</con:property>
          <con:property>SupplierProductCode</con:property>
          <con:property>SupplierOptionCode</con:property>
          <con:property>SupplierOptionName</con:property>
          <con:property>TourDepartureTime</con:property>
          <con:property>TourDuration</con:property>
          <con:property>LanguageCode</con:property>
          <con:property>LanguageOption</con:property>
          <con:property>Option.Name</con:property>
          <con:property>Option.Value</con:property>
          <con:property>Expiry</con:property>
          <con:property>Adult</con:property>
          <con:property>Child</con:property>
          <con:property>Youth</con:property>
          <con:property>Infant</con:property>
          <con:property>Senior</con:property>
          <con:property>Total</con:property>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="f4d78032-df3d-487a-b15a-bd451d535650">
        <con:settings/>
        <con:config service="http://bb-viator-api-v.eu.cloudhub.io" resourcePath="/api/1/products/availability" methodName="Availability" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="398b8177-7e96-4821-b532-20216c36ac53" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>${#Project#endpoint}</con:endpoint>
            <con:request>{
  "requestType":"${DataSource#requestType}",
  "data":{
    "ApiKey":"${DataSource#ApiKey}",
    "ResellerId":"${DataSource#ResellerId}",
    "SupplierId":"${DataSource#SupplierId}",
    "ExternalReference":"${DataSource#ExternalReference}",
    "Timestamp":"${DataSource#Timestamp}",
    "StartDate":"${DataSource#StartDate}",
    "EndDate":"${DataSource#EndDate}",
    "DeltaOnly":"${DataSource#DeltaOnly}",
    "SupplierProductCode":"${DataSource#SupplierProductCode}",
    "TourOptions":{
      "SupplierOptionCode":"${DataSource#SupplierOptionCode}",
      "SupplierOptionName":"${DataSource#SupplierOptionName}",
      "TourDepartureTime":"${DataSource#TourDepartureTime}",
      "TourDuration":"${DataSource#TourDuration}",
       "Option":{
        "Name":"${DataSource#Option.Name}",
        "Value":"${DataSource#Option.Value}"
      },
      "Language":{
        "LanguageCode":"${DataSource#LanguageCode}",
        "LanguageOption":"${DataSource#LanguageOption}"
      }
    },
    "AvailabilityHold":{
      "Expiry":"${DataSource#Expiry}"
    },
    "TravellerMix":{
      "Adult":"${DataSource#Adult}",
      "Child":"${DataSource#Child}",
      "Youth":"${DataSource#Youth}",
      "Infant":"${DataSource#Infant}",
      "Senior":"${DataSource#Senior}",
      "Total":"${DataSource#Total}"
    }
  }
}</con:request>
            <con:originalUri>https://bb-viator-trade-api-d.eu.cloudhub.io/api/1/products/availability</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>Inherit From Parent</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="transfer" name="Property Transfer" id="64880b05-1b46-4fdc-8906-0848c28d7c25">
        <con:settings/>
        <con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>responseType</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>responseType</con:sourcePath>
            <con:targetType>responseType</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>status</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.Status[0]</con:sourcePath>
            <con:targetType>status</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:targetPath/>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>response</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath/>
            <con:targetType>response</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>failReason</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.ErrorMessage[0]</con:sourcePath>
            <con:targetType>failReason</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="SaveXmls" id="8e14add8-4b58-443e-a9c8-abbd092e89a7">
        <con:settings/>
        <con:config>
          <script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def name = context.expand( '${Properties#Filename}' )
def location = context.expand( '${Properties#SaveLocation}' )
log.info(location)
def getResponseFilename(name) {
   count = ( testRunner.testCase.testSteps["DataSource"].currentRow )
   date = new Date()
   dateFormat = new java.text.SimpleDateFormat('yyyyMMdd-kkmmss')
   shortDate = dateFormat.format(date)
def testCaseID = context.expand( '${DataSource#Test Case}' )
   respFilename = shortDate + "-" + testCaseID + "-response.xml"  // implicitely returned
}

def getRequestFilename(name) {  
	def testCaseID = context.expand( '${DataSource#Test Case}' ) 
	reqFilename = shortDate + "-" + testCaseID + "-request.xml"  // implicitely returned
}
	
def file = new PrintWriter (location + getResponseFilename(name))
log.info(name)
def Response = testRunner.testCase.testSteps["Request"].testRequest.response.contentAsString
log.info(Response)
file.println(Response)
file.flush()
file.close()

def file2 = new PrintWriter (location + getRequestFilename(name))
def Request = context.expand( '${Request#Request}' )
file2.println(Request)
file2.flush()
file2.close()</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="8713a50f-9383-464c-8d1b-8ff7e5ae3cbd">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorAvailability_TestData.xlsx</file>
              <outfile>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorAvailability_TestData.xlsx</outfile>
              <worksheet>Results</worksheet>
              <cell>A4</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Test Case</con:name>
              <con:value>${DataSource#Test Case}</con:value>
            </con:property>
            <con:property>
              <con:name>description</con:name>
              <con:value>${DataSource#Description (optional)}</con:value>
            </con:property>
            <con:property>
              <con:name>request</con:name>
              <con:value>${#TestSuite#RequestType}</con:value>
            </con:property>
            <con:property>
              <con:name>Test Case Status</con:name>
              <con:value>${#Project#status}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail Reason</con:name>
              <con:value>${#Project#failReason}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${#Project#response}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="b81088b0-a7d0-44ef-9267-05a2f919bda3">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>Request</targetStep>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>3e41b0d4-aeab-47e4-b71d-a4b9a93a638d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
    </con:testCase>
    <con:testCase id="f722c253-f576-4a57-8a83-8b6614882099" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="Availability_MO" searchProperties="true" timeout="0" maxResults="0">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="34c10059-6a8c-4f62-a88c-2c683acbe5af">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\TestData\BigBusViatorAvailability_TestData.xlsx</con:value>
            </con:property>
            <con:property>
              <con:name>SaveLocation</con:name>
              <con:value>${projectDir}\TestResults\Availability\</con:value>
            </con:property>
            <con:property>
              <con:name>TestDataSheetName</con:name>
              <con:value>BMO</con:value>
            </con:property>
            <con:property>
              <con:name>Filename</con:name>
              <con:value>BigBusViatorAvailability_TestData</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="af9b33c9-5254-407f-b79b-f468b991cc23">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>${Properties#Source}</file>
              <worksheet>MO</worksheet>
              <cell>A7</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Test Case</con:property>
          <con:property>Description (optional)</con:property>
          <con:property>requestType</con:property>
          <con:property>ApiKey</con:property>
          <con:property>ResellerId</con:property>
          <con:property>SupplierId</con:property>
          <con:property>ExternalReference</con:property>
          <con:property>Timestamp</con:property>
          <con:property>StartDate</con:property>
          <con:property>EndDate</con:property>
          <con:property>DeltaOnly</con:property>
          <con:property>DeltaSince</con:property>
          <con:property>SupplierProductCode</con:property>
          <con:property>SupplierOptionCode</con:property>
          <con:property>SupplierOptionName</con:property>
          <con:property>TourDepartureTime</con:property>
          <con:property>TourDuration</con:property>
          <con:property>LanguageCode</con:property>
          <con:property>LanguageOption</con:property>
          <con:property>Option.Name</con:property>
          <con:property>Option.Value</con:property>
          <con:property>Expiry</con:property>
          <con:property>Adult</con:property>
          <con:property>Child</con:property>
          <con:property>Youth</con:property>
          <con:property>Infant</con:property>
          <con:property>Senior</con:property>
          <con:property>Total</con:property>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="9b1727e4-dbec-4697-ae0f-5d2f79401b53">
        <con:settings/>
        <con:config service="http://bb-viator-api-v.eu.cloudhub.io" resourcePath="/api/1/products/availability" methodName="Availability" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="398b8177-7e96-4821-b532-20216c36ac53" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>${#Project#endpoint}</con:endpoint>
            <con:request>{
  "requestType":"${DataSource#requestType}",
  "data":{
    "ApiKey":"${DataSource#ApiKey}",
    "ResellerId":"${DataSource#ResellerId}",
    "SupplierId":"${DataSource#SupplierId}",
    "ExternalReference":"${DataSource#ExternalReference}",
    "Timestamp":"${DataSource#Timestamp}",
    "StartDate":"${DataSource#StartDate}",
    "EndDate":"${DataSource#EndDate}",
    "DeltaOnly":"${DataSource#DeltaOnly}",
    "SupplierProductCode":"${DataSource#SupplierProductCode}",
    "TourOptions":{
      "SupplierOptionCode":"${DataSource#SupplierOptionCode}",
      "SupplierOptionName":"${DataSource#SupplierOptionName}",
      "TourDepartureTime":"${DataSource#TourDepartureTime}",
      "TourDuration":"${DataSource#TourDuration}",
        "Option":{
        "Name":"${DataSource#Option.Name}",
        "Value":"${DataSource#Option.Value}"
      },
      "Language":{
        "LanguageCode":"${DataSource#LanguageCode}",
        "LanguageOption":"${DataSource#LanguageOption}"
      }
    },
    "AvailabilityHold":{
      "Expiry":"${DataSource#Expiry}"
    },
    "TravellerMix":{
      "Adult":"${DataSource#Adult}",
      "Child":"${DataSource#Child}",
      "Youth":"${DataSource#Youth}",
      "Infant":"${DataSource#Infant}",
      "Senior":"${DataSource#Senior}",
      "Total":"${DataSource#Total}"
    }
  }
}</con:request>
            <con:originalUri>http://bb-viator-api-v.eu.cloudhub.io/api/1/products/availability</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>Inherit From Parent</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="transfer" name="Property Transfer" id="48bcc212-aedb-405b-a009-213c05e246da">
        <con:settings/>
        <con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>responseType</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>responseType</con:sourcePath>
            <con:targetType>responseType</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>status</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.Status[0]</con:sourcePath>
            <con:targetType>status</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:targetPath/>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>response</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath/>
            <con:targetType>response</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>failReason</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.ErrorMessage[0]</con:sourcePath>
            <con:targetType>failReason</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="SaveXmls" id="6703952e-98e5-4fcc-922e-7265f6302270">
        <con:settings/>
        <con:config>
          <script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def name = context.expand( '${Properties#Filename}' )
def location = context.expand( '${Properties#SaveLocation}' )
log.info(location)
def getResponseFilename(name) {
   count = ( testRunner.testCase.testSteps["DataSource"].currentRow )
   date = new Date()
   dateFormat = new java.text.SimpleDateFormat('yyyyMMdd-kkmmss')
   shortDate = dateFormat.format(date)
def testCaseID = context.expand( '${DataSource#Test Case}' )
   respFilename = shortDate + "-" + testCaseID + "-response.xml"  // implicitely returned
}

def getRequestFilename(name) {  
	def testCaseID = context.expand( '${DataSource#Test Case}' ) 
	reqFilename = shortDate + "-" + testCaseID + "-request.xml"  // implicitely returned
}
	
def file = new PrintWriter (location + getResponseFilename(name))
log.info(name)
def Response = testRunner.testCase.testSteps["Request"].testRequest.response.contentAsString
log.info(Response)
file.println(Response)
file.flush()
file.close()

def file2 = new PrintWriter (location + getRequestFilename(name))
def Request = context.expand( '${Request#Request}' )
file2.println(Request)
file2.flush()
file2.close()</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="5a0b85c6-7130-4eb6-ac51-65b671168a03">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorAvailability_TestData.xlsx</file>
              <outfile>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorAvailability_TestData.xlsx</outfile>
              <worksheet>Results</worksheet>
              <cell>A6</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Test Case</con:name>
              <con:value>${DataSource#Test Case}</con:value>
            </con:property>
            <con:property>
              <con:name>description</con:name>
              <con:value>${DataSource#Description (optional)}</con:value>
            </con:property>
            <con:property>
              <con:name>request</con:name>
              <con:value>${#TestSuite#RequestType}</con:value>
            </con:property>
            <con:property>
              <con:name>Test Case Status</con:name>
              <con:value>${#Project#status}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail Reason</con:name>
              <con:value>${#Project#failReason}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${#Project#response}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="f502145a-106e-409f-b77e-4aba9a2d0f9d">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>Request</targetStep>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>f502145a-106e-409f-b77e-4aba9a2d0f9d</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>af9b33c9-5254-407f-b79b-f468b991cc23</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>5a0b85c6-7130-4eb6-ac51-65b671168a03</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>48bcc212-aedb-405b-a009-213c05e246da</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
    </con:testCase>
    <con:testCase id="86de8623-bc66-4201-bb94-7c481ed0e27d" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="Availability_MM" searchProperties="true" timeout="0" maxResults="0">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="7959a8ae-f2cf-486e-92cd-c15526425486">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\TestData\BigBusViatorAvailability_TestData.xlsx</con:value>
            </con:property>
            <con:property>
              <con:name>SaveLocation</con:name>
              <con:value>${projectDir}\TestResults\Availability\</con:value>
            </con:property>
            <con:property>
              <con:name>TestDataSheetName</con:name>
              <con:value>BMO</con:value>
            </con:property>
            <con:property>
              <con:name>Filename</con:name>
              <con:value>BigBusViatorAvailability_TestData</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="7f90cb55-7db0-48b3-8ea7-bb05f2ed56c7">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>${Properties#Source}</file>
              <worksheet>MM</worksheet>
              <cell>A7</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Test Case</con:property>
          <con:property>Description (optional)</con:property>
          <con:property>requestType</con:property>
          <con:property>ApiKey</con:property>
          <con:property>ResellerId</con:property>
          <con:property>SupplierId</con:property>
          <con:property>ExternalReference</con:property>
          <con:property>Timestamp</con:property>
          <con:property>StartDate</con:property>
          <con:property>EndDate</con:property>
          <con:property>DeltaOnly</con:property>
          <con:property>DeltaSince</con:property>
          <con:property>SupplierProductCode</con:property>
          <con:property>SupplierOptionCode</con:property>
          <con:property>SupplierOptionName</con:property>
          <con:property>TourDepartureTime</con:property>
          <con:property>TourDuration</con:property>
          <con:property>LanguageCode</con:property>
          <con:property>LanguageOption</con:property>
          <con:property>Option.Name</con:property>
          <con:property>Option.Value</con:property>
          <con:property>Expiry</con:property>
          <con:property>Adult</con:property>
          <con:property>Child</con:property>
          <con:property>Youth</con:property>
          <con:property>Infant</con:property>
          <con:property>Senior</con:property>
          <con:property>Total</con:property>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="c23954e2-13df-4b7d-a515-df77897cc014">
        <con:settings/>
        <con:config service="http://bb-viator-api-v.eu.cloudhub.io" resourcePath="/api/1/products/availability" methodName="Availability" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="398b8177-7e96-4821-b532-20216c36ac53" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>${#Project#endpoint}</con:endpoint>
            <con:request>{
  "requestType":"${DataSource#requestType}",
  "data":{
    "ApiKey":"${DataSource#ApiKey}",
    "ResellerId":"${DataSource#ResellerId}",
    "SupplierId":"${DataSource#SupplierId}",
    "ExternalReference":"${DataSource#ExternalReference}",
    "Timestamp":"${DataSource#Timestamp}",
    "StartDate":"${DataSource#StartDate}",
    "EndDate":"${DataSource#EndDate}",
    "DeltaOnly":"${DataSource#DeltaOnly}",
    "SupplierProductCode":"${DataSource#SupplierProductCode}",
    "TourOptions":{
      "SupplierOptionCode":"${DataSource#SupplierOptionCode}",
      "SupplierOptionName":"${DataSource#SupplierOptionName}",
      "TourDepartureTime":"${DataSource#TourDepartureTime}",
      "TourDuration":"${DataSource#TourDuration}",
        "Option":{
        "Name":"${DataSource#Option.Name}",
        "Value":"${DataSource#Option.Value}"
      },
      "Language":{
        "LanguageCode":"${DataSource#LanguageCode}",
        "LanguageOption":"${DataSource#LanguageOption}"
      }
    },
    "AvailabilityHold":{
      "Expiry":"${DataSource#Expiry}"
    },
    "TravellerMix":{
      "Adult":"${DataSource#Adult}",
      "Child":"${DataSource#Child}",
      "Youth":"${DataSource#Youth}",
      "Infant":"${DataSource#Infant}",
      "Senior":"${DataSource#Senior}",
      "Total":"${DataSource#Total}"
    }
  }
}</con:request>
            <con:originalUri>http://bb-viator-api-v.eu.cloudhub.io/api/1/products/availability</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>Inherit From Parent</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="transfer" name="Property Transfer" id="46a57fc0-7fb6-40a4-8d0a-fa6b52317633">
        <con:settings/>
        <con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>responseType</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>responseType</con:sourcePath>
            <con:targetType>responseType</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>status</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.Status[0]</con:sourcePath>
            <con:targetType>status</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:targetPath/>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>response</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath/>
            <con:targetType>response</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>failReason</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.ErrorMessage[0]</con:sourcePath>
            <con:targetType>failReason</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="SaveXmls" id="a76a18fd-20fc-44db-9da2-a6cb889c894f">
        <con:settings/>
        <con:config>
          <script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def name = context.expand( '${Properties#Filename}' )
def location = context.expand( '${Properties#SaveLocation}' )
log.info(location)
def getResponseFilename(name) {
   count = ( testRunner.testCase.testSteps["DataSource"].currentRow )
   date = new Date()
   dateFormat = new java.text.SimpleDateFormat('yyyyMMdd-kkmmss')
   shortDate = dateFormat.format(date)
def testCaseID = context.expand( '${DataSource#Test Case}' )
   respFilename = shortDate + "-" + testCaseID + "-response.xml"  // implicitely returned
}

def getRequestFilename(name) {  
	def testCaseID = context.expand( '${DataSource#Test Case}' ) 
	reqFilename = shortDate + "-" + testCaseID + "-request.xml"  // implicitely returned
}
	
def file = new PrintWriter (location + getResponseFilename(name))
log.info(name)
def Response = testRunner.testCase.testSteps["Request"].testRequest.response.contentAsString
log.info(Response)
file.println(Response)
file.flush()
file.close()

def file2 = new PrintWriter (location + getRequestFilename(name))
def Request = context.expand( '${Request#Request}' )
file2.println(Request)
file2.flush()
file2.close()</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="c684accc-a276-4c66-a504-c1b899899cb5">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorAvailability_TestData.xlsx</file>
              <outfile>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorAvailability_TestData.xlsx</outfile>
              <worksheet>Results</worksheet>
              <cell>A9</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Test Case</con:name>
              <con:value>${DataSource#Test Case}</con:value>
            </con:property>
            <con:property>
              <con:name>description</con:name>
              <con:value>${DataSource#Description (optional)}</con:value>
            </con:property>
            <con:property>
              <con:name>request</con:name>
              <con:value>${#TestSuite#RequestType}</con:value>
            </con:property>
            <con:property>
              <con:name>Test Case Status</con:name>
              <con:value>${#Project#status}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail Reason</con:name>
              <con:value>${#Project#failReason}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${#Project#response}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="df00320d-4e38-4ebe-bc45-6cd6da901e3e">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>Request</targetStep>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>7f90cb55-7db0-48b3-8ea7-bb05f2ed56c7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>46a57fc0-7fb6-40a4-8d0a-fa6b52317633</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
    </con:testCase>
    <con:testCase id="242a643c-adfb-46e8-8759-a0224f0c2ddc" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="Availability_ID" searchProperties="true" timeout="0" maxResults="0">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="3405abd3-c563-43ab-9625-ae8a4190342a">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\TestData\BigBusViatorAvailability_TestData.xlsx</con:value>
            </con:property>
            <con:property>
              <con:name>SaveLocation</con:name>
              <con:value>${projectDir}\TestResults\Availability\</con:value>
            </con:property>
            <con:property>
              <con:name>TestDataSheetName</con:name>
              <con:value>BMO</con:value>
            </con:property>
            <con:property>
              <con:name>Filename</con:name>
              <con:value>BigBusViatorAvailability_TestData</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="f222eab3-4da5-453c-beb3-36a1edacd498">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>${Properties#Source}</file>
              <worksheet>ID</worksheet>
              <cell>A7</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Test Case</con:property>
          <con:property>Description (optional)</con:property>
          <con:property>requestType</con:property>
          <con:property>ApiKey</con:property>
          <con:property>ResellerId</con:property>
          <con:property>SupplierId</con:property>
          <con:property>ExternalReference</con:property>
          <con:property>Timestamp</con:property>
          <con:property>StartDate</con:property>
          <con:property>EndDate</con:property>
          <con:property>DeltaOnly</con:property>
          <con:property>DeltaSince</con:property>
          <con:property>SupplierProductCode</con:property>
          <con:property>SupplierOptionCode</con:property>
          <con:property>SupplierOptionName</con:property>
          <con:property>TourDepartureTime</con:property>
          <con:property>TourDuration</con:property>
          <con:property>LanguageCode</con:property>
          <con:property>LanguageOption</con:property>
          <con:property>Option.Name</con:property>
          <con:property>Option.Value</con:property>
          <con:property>Expiry</con:property>
          <con:property>Adult</con:property>
          <con:property>Child</con:property>
          <con:property>Youth</con:property>
          <con:property>Infant</con:property>
          <con:property>Senior</con:property>
          <con:property>Total</con:property>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="235ae059-dc92-40e1-9987-abb798339ca5">
        <con:settings/>
        <con:config service="http://bb-viator-api-v.eu.cloudhub.io" resourcePath="/api/1/products/availability" methodName="Availability" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="398b8177-7e96-4821-b532-20216c36ac53" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>${#Project#endpoint}</con:endpoint>
            <con:request>{
  "requestType":"${DataSource#requestType}",
  "data":{
    "ApiKey":"${DataSource#ApiKey}",
    "ResellerId":"${DataSource#ResellerId}",
    "SupplierId":"${DataSource#SupplierId}",
    "ExternalReference":"${DataSource#ExternalReference}",
    "Timestamp":"${DataSource#Timestamp}",
    "StartDate":"${DataSource#StartDate}",
    "EndDate":"${DataSource#EndDate}",
    "DeltaOnly":"${DataSource#DeltaOnly}",
    "SupplierProductCode":"${DataSource#SupplierProductCode}",
    "TourOptions":{
      "SupplierOptionCode":"${DataSource#SupplierOptionCode}",
      "SupplierOptionName":"${DataSource#SupplierOptionName}",
      "TourDepartureTime":"${DataSource#TourDepartureTime}",
      "TourDuration":"${DataSource#TourDuration}",
      "Language":{
        "LanguageCode":"${DataSource#LanguageCode}",
        "LanguageOption":"${DataSource#LanguageOption}"
      }
    },
    "AvailabilityHold":{
      "Expiry":"${DataSource#Expiry}"
    },
    "TravellerMix":{
      "Adult":"${DataSource#Adult}",
      "Child":"${DataSource#Child}",
      "Youth":"${DataSource#Youth}",
      "Infant":"${DataSource#Infant}",
      "Senior":"${DataSource#Senior}",
      "Total":"${DataSource#Total}"
    }
  }
}</con:request>
            <con:originalUri>https://bb-viator-trade-api-d.eu.cloudhub.io/api/1/products/availability</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>Inherit From Parent</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="transfer" name="Property Transfer" id="71b4ac65-7272-4cc7-8886-86d3b2ed6224">
        <con:settings/>
        <con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>responseType</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>responseType</con:sourcePath>
            <con:targetType>responseType</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>status</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.Status[0]</con:sourcePath>
            <con:targetType>status</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:targetPath/>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>response</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath/>
            <con:targetType>response</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>failReason</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.ErrorMessage[0]</con:sourcePath>
            <con:targetType>failReason</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="SaveXmls" id="f02c323e-8c46-48a3-8a32-97936b755469">
        <con:settings/>
        <con:config>
          <script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def name = context.expand( '${Properties#Filename}' )
def location = context.expand( '${Properties#SaveLocation}' )
log.info(location)
def getResponseFilename(name) {
   count = ( testRunner.testCase.testSteps["DataSource"].currentRow )
   date = new Date()
   dateFormat = new java.text.SimpleDateFormat('yyyyMMdd-kkmmss')
   shortDate = dateFormat.format(date)
def testCaseID = context.expand( '${DataSource#Test Case}' )
   respFilename = shortDate + "-" + testCaseID + "-response.xml"  // implicitely returned
}

def getRequestFilename(name) {  
	def testCaseID = context.expand( '${DataSource#Test Case}' ) 
	reqFilename = shortDate + "-" + testCaseID + "-request.xml"  // implicitely returned
}
	
def file = new PrintWriter (location + getResponseFilename(name))
log.info(name)
def Response = testRunner.testCase.testSteps["Request"].testRequest.response.contentAsString
log.info(Response)
file.println(Response)
file.flush()
file.close()

def file2 = new PrintWriter (location + getRequestFilename(name))
def Request = context.expand( '${Request#Request}' )
file2.println(Request)
file2.flush()
file2.close()</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="73c63e85-d44f-41f7-adfb-f0f1f0687bf7">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>${Properties#Source}</file>
              <outfile>${Properties#Source}</outfile>
              <worksheet>Results</worksheet>
              <cell>A15</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Test Case</con:name>
              <con:value>${DataSource#Test Case}</con:value>
            </con:property>
            <con:property>
              <con:name>description</con:name>
              <con:value>${DataSource#Description (optional)}</con:value>
            </con:property>
            <con:property>
              <con:name>request</con:name>
              <con:value>${#TestSuite#RequestType}</con:value>
            </con:property>
            <con:property>
              <con:name>Test Case Status</con:name>
              <con:value>${#Project#status}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail Reason</con:name>
              <con:value>${#Project#failReason}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${#Project#response}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="5fe5a7eb-8220-42fa-a130-993c47cbb6e7">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>Request</targetStep>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>f222eab3-4da5-453c-beb3-36a1edacd498</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>71b4ac65-7272-4cc7-8886-86d3b2ed6224</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
    </con:testCase>
    <con:properties>
      <con:property>
        <con:name>RequestType</con:name>
        <con:value>AvailabilityRequest</con:value>
      </con:property>
    </con:properties>
    <con:reportParameters/>
  </con:testSuite>
  <con:testSuite id="8f961085-1d1a-46bf-87a3-36c809554edb" name="Booking_TestSuite">
    <con:settings/>
    <con:savedRecentRuns>1</con:savedRecentRuns>
    <con:runType>SEQUENTIAL</con:runType>
    <con:testCase id="4d057532-5f20-42fb-9b08-15c5ab340022" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="Booking_BMO" searchProperties="true" timeout="0" maxResults="0">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="673f1071-e08a-4972-a2ef-e3605b5b6d4b">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\TestData\BigBusViatorBooking_TestData.xlsx</con:value>
            </con:property>
            <con:property>
              <con:name>SaveLocation</con:name>
              <con:value>${projectDir}\TestResults\Booking\</con:value>
            </con:property>
            <con:property>
              <con:name>TestDataSheetName</con:name>
              <con:value>BMO</con:value>
            </con:property>
            <con:property>
              <con:name>Filename</con:name>
              <con:value>BigBusViatorBooking_TestData</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="a4defb16-7654-4e70-ae3f-fef404d6ce5a">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorBooking_TestData.xlsx</file>
              <worksheet>BMO</worksheet>
              <cell>A7</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Test Case</con:property>
          <con:property>Description (optional)</con:property>
          <con:property>requestType</con:property>
          <con:property>ApiKey</con:property>
          <con:property>ResellerId</con:property>
          <con:property>SupplierId</con:property>
          <con:property>ExternalReference</con:property>
          <con:property>Timestamp</con:property>
          <con:property>Extension</con:property>
          <con:property>Parameter.Name</con:property>
          <con:property>Parameter.Value</con:property>
          <con:property>BookingReference</con:property>
          <con:property>TravelDate</con:property>
          <con:property>SupplierProductCode</con:property>
          <con:property>Location</con:property>
          <con:property>SupplierOptionCode</con:property>
          <con:property>SupplierOptionName</con:property>
          <con:property>TourDepartureTime</con:property>
          <con:property>TourDuration</con:property>
          <con:property>LanguageCode</con:property>
          <con:property>LanguageOption</con:property>
          <con:property>Option.Name</con:property>
          <con:property>Option.Value</con:property>
          <con:property>Inclusion</con:property>
          <con:property>CurrencyCode</con:property>
          <con:property>Amount</con:property>
          <con:property>TravellerIdentifier</con:property>
          <con:property>TravellerTitle</con:property>
          <con:property>GivenName</con:property>
          <con:property>Surname</con:property>
          <con:property>AgeBand</con:property>
          <con:property>LeadTraveller</con:property>
          <con:property>Adult</con:property>
          <con:property>Child</con:property>
          <con:property>Youth</con:property>
          <con:property>Infant</con:property>
          <con:property>Senior</con:property>
          <con:property>Total</con:property>
          <con:property>Question</con:property>
          <con:property>QuestionText</con:property>
          <con:property>QuestionAnswer</con:property>
          <con:property>SpecialRequirement</con:property>
          <con:property>PickupPoint</con:property>
          <con:property>SupplierNote</con:property>
          <con:property>Remark</con:property>
          <con:property>ContactType</con:property>
          <con:property>ContactName</con:property>
          <con:property>ContactValue</con:property>
          <con:property>AvailabiltyHoldReference</con:property>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="8b50ae9d-10ee-4c8e-869d-a892eeecfeee">
        <con:settings/>
        <con:config service="http://bb-viator-api-v.eu.cloudhub.io" resourcePath="/api/1/bookings" methodName="Booking" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="398b8177-7e96-4821-b532-20216c36ac53" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>${#Project#endpoint}</con:endpoint>
            <con:request>{
   "requestType": "${DataSource#requestType}",
   "data":    {
      "ApiKey": "${DataSource#ApiKey}",
      "ResellerId": "${DataSource#ResellerId}",
      "SupplierId": "${DataSource#SupplierId}",
      "ExternalReference": "${DataSource#ExternalReference}",
      "Timestamp": "${DataSource#Timestamp}",
      "BookingReference": "${DataSource#BookingReference}",
      "TravelDate": "${DataSource#TravelDate}",
      "SupplierProductCode": "${DataSource#SupplierProductCode}",
      "Location": "${DataSource#Location}",
      "TourOptions":       {
         "Language":          {
            "LanguageCode": "${DataSource#LanguageCode}",
            "LanguageOption": ["${DataSource#LanguageOption}"]
         },
         "SupplierOptionCode": "${DataSource#SupplierOptionCode}",
         "TourDepartureTime": "${DataSource#TourDepartureTime}",
         "Option": [         {
            "Name": "${DataSource#Option.Name}",
            "Value": "${DataSource#Option.Value}"
         }]
      },
      "Inclusions": {"Inclusion": ["${DataSource#Inclusion}"]},
      "CurrencyCode": "${DataSource#CurrencyCode}",
      "Amount": 100,
      "Traveller": [      {
         "TravellerIdentifier": "${DataSource#TravellerIdentifier}",
         "TravellerTitle": "${DataSource#TravellerTitle}",
         "GivenName": "${DataSource#GivenName}",
         "Surname": "${DataSource#Surname}",
         "AgeBand": "${DataSource#AgeBand}",
         "LeadTraveller": true
      }],
      "TravellerMix":       {
         "Adult": "${DataSource#Adult}",
         "Child": "${DataSource#Child}",
         "Youth": "${DataSource#Youth}",
         "Infant": "${DataSource#Infant}",
         "Senior": "${DataSource#Senior}",
         "Total": "${DataSource#Total}"
      },
      "RequiredInfo":       {
         "Question": "${DataSource#Question}",
         "QuestionText": "${DataSource#QuestionText}",
         "QuestionAnswer": "${DataSource#QuestionAnswer}"
      },
      "SpecialRequirement": "${DataSource#SpecialRequirement}",
      "PickupPoint": "${DataSource#PickupPoint}",
      "SupplierNote": "${DataSource#SupplierNote}",
      "AdditionalRemarks": {"Remark": "${DataSource#Remark}"},
      "ContactDetail":       {
         "ContactType": "${DataSource#ContactType}",
         "ContactName": "${DataSource#ContactName}",
         "ContactValue": "${DataSource#ContactValue}"
      },
      "AvailabiltyHoldReference": "${DataSource#AvailabiltyHoldReference}"
   }
}</con:request>
            <con:originalUri>http://bb-viator-api-v.eu.cloudhub.io/api/1/bookings</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>Inherit From Parent</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="transfer" name="Property Transfer" id="09235feb-8375-4d23-a606-ec8618d06eb5">
        <con:settings/>
        <con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>responseType</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>responseType</con:sourcePath>
            <con:targetType>responseType</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>status</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.Status[0]</con:sourcePath>
            <con:targetType>status</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:targetPath/>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>response</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath/>
            <con:targetType>response</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>supplierConfiramtion</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>['data']['Traveller'][0][0]['ConfirmationNumber']</con:sourcePath>
            <con:targetType>supplierConfirmation</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>FailReason</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.ErrorMessage[0]</con:sourcePath>
            <con:targetType>failReason</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="SaveXmls" id="a760b300-9868-4a9f-8847-be4aecf3fb6a">
        <con:settings/>
        <con:config>
          <script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def name = context.expand( '${Properties#Filename}' )
def location = context.expand( '${Properties#SaveLocation}' )
log.info(location)
def getResponseFilename(name) {
   count = ( testRunner.testCase.testSteps["DataSource"].currentRow )
   date = new Date()
   dateFormat = new java.text.SimpleDateFormat('yyyyMMdd-kkmmss')
   shortDate = dateFormat.format(date)
def testCaseID = context.expand( '${DataSource#Test Case}' )
   respFilename = shortDate + "-" + testCaseID + "-response.xml"  // implicitely returned
}

def getRequestFilename(name) {  
	def testCaseID = context.expand( '${DataSource#Test Case}' ) 
	reqFilename = shortDate + "-" + testCaseID + "-request.xml"  // implicitely returned
}
	
def file = new PrintWriter (location + getResponseFilename(name))
log.info(name)
def Response = testRunner.testCase.testSteps["Request"].testRequest.response.contentAsString
log.info(Response)
file.println(Response)
file.flush()
file.close()

def file2 = new PrintWriter (location + getRequestFilename(name))
def Request = context.expand( '${Request#Request}' )
file2.println(Request)
file2.flush()
file2.close()</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="39f139cb-834d-4542-abc5-c3debc801d86">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorBooking_TestData.xlsx</file>
              <outfile>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorBooking_TestData.xlsx</outfile>
              <worksheet>Results</worksheet>
              <cell>A4</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Test Case</con:name>
              <con:value>${DataSource#Test Case}</con:value>
            </con:property>
            <con:property>
              <con:name>description</con:name>
              <con:value>${DataSource#Description (optional)}</con:value>
            </con:property>
            <con:property>
              <con:name>request</con:name>
              <con:value>${#TestSuite#RequestType}</con:value>
            </con:property>
            <con:property>
              <con:name>Test Case Status</con:name>
              <con:value>${#Project#status}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail Reason</con:name>
              <con:value>${#Project#failReason}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${#Project#response}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="a84ed234-7773-4318-b38e-7e105c07da7c">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>Request</targetStep>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>a4defb16-7654-4e70-ae3f-fef404d6ce5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
    </con:testCase>
    <con:testCase id="3115f600-2e29-4b21-98bb-4265d45d5946" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="Booking_MO" searchProperties="true" timeout="0" maxResults="0">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="0e8852e8-5b83-4071-8d45-39ca2d2abc09">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\TestData\BigBusViatorBooking_TestData.xlsx</con:value>
            </con:property>
            <con:property>
              <con:name>SaveLocation</con:name>
              <con:value>${projectDir}\TestResults\Booking\</con:value>
            </con:property>
            <con:property>
              <con:name>TestDataSheetName</con:name>
              <con:value>MO</con:value>
            </con:property>
            <con:property>
              <con:name>Filename</con:name>
              <con:value>BigBusViatorBooking_TestData</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="955361ee-c6ea-4f74-9a5d-cef95f01b1e8">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorBooking_TestData.xlsx</file>
              <worksheet>MO</worksheet>
              <cell>A7</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Test Case</con:property>
          <con:property>Description (optional)</con:property>
          <con:property>requestType</con:property>
          <con:property>ApiKey</con:property>
          <con:property>ResellerId</con:property>
          <con:property>SupplierId</con:property>
          <con:property>ExternalReference</con:property>
          <con:property>Timestamp</con:property>
          <con:property>Extension</con:property>
          <con:property>Parameter.Name</con:property>
          <con:property>Parameter.Value</con:property>
          <con:property>BookingReference</con:property>
          <con:property>TravelDate</con:property>
          <con:property>SupplierProductCode</con:property>
          <con:property>Location</con:property>
          <con:property>SupplierOptionCode</con:property>
          <con:property>SupplierOptionName</con:property>
          <con:property>TourDepartureTime</con:property>
          <con:property>TourDuration</con:property>
          <con:property>LanguageCode</con:property>
          <con:property>LanguageOption</con:property>
          <con:property>Option.Name</con:property>
          <con:property>Option.Value</con:property>
          <con:property>Inclusion</con:property>
          <con:property>CurrencyCode</con:property>
          <con:property>Amount</con:property>
          <con:property>TravellerIdentifier</con:property>
          <con:property>TravellerTitle</con:property>
          <con:property>GivenName</con:property>
          <con:property>Surname</con:property>
          <con:property>AgeBand</con:property>
          <con:property>LeadTraveller</con:property>
          <con:property>Adult</con:property>
          <con:property>Child</con:property>
          <con:property>Youth</con:property>
          <con:property>Infant</con:property>
          <con:property>Senior</con:property>
          <con:property>Total</con:property>
          <con:property>Question</con:property>
          <con:property>QuestionText</con:property>
          <con:property>QuestionAnswer</con:property>
          <con:property>SpecialRequirement</con:property>
          <con:property>PickupPoint</con:property>
          <con:property>SupplierNote</con:property>
          <con:property>Remark</con:property>
          <con:property>ContactType</con:property>
          <con:property>ContactName</con:property>
          <con:property>ContactValue</con:property>
          <con:property>AvailabiltyHoldReference</con:property>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="a4909d30-e62e-465a-8daf-5d7c288e45fd">
        <con:settings/>
        <con:config service="http://bb-viator-api-v.eu.cloudhub.io" resourcePath="/api/1/bookings" methodName="Booking" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="398b8177-7e96-4821-b532-20216c36ac53" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>${#Project#endpoint}</con:endpoint>
            <con:request>{
	"requestType": "${DataSource#requestType}",
	"data": {
		"ApiKey": "${DataSource#ApiKey}",
		"ResellerId": "${DataSource#ResellerId}",
		"SupplierId": "${DataSource#SupplierId}",
		"ExternalReference": "${DataSource#ExternalReference}",
		"Timestamp": "${DataSource#Timestamp}",
		"BookingReference": "${DataSource#BookingReference}",
		"TravelDate": "${DataSource#TravelDate}",
		"SupplierProductCode": "${DataSource#SupplierProductCode}",
		"Location": "${DataSource#Location}",
		"TourOptions": {
			"Language": {
				"LanguageCode": "${DataSource#LanguageCode}",
				"LanguageOption": ["${DataSource#LanguageOption}"]
			},
			"SupplierOptionCode": "${DataSource#SupplierOptionCode}",
			"TourDepartureTime": "${DataSource#TourDepartureTime}",
			"Option": [{
				"Name": "${DataSource#Option.Name}",
				"Value": "${DataSource#Option.Value}"
			}]
		},
		"Inclusions": {
			"Inclusion":[ "${DataSource#Inclusion}"]
		},
		"CurrencyCode": "${DataSource#CurrencyCode}",
		"Amount": 100,
	"Traveller": [{
		"TravellerIdentifier": "${DataSource#TravellerIdentifier}",
		"TravellerTitle": "${DataSource#TravellerTitle}",
		"GivenName": "${DataSource#GivenName}",
		"Surname": "${DataSource#Surname}",
		"AgeBand": "${DataSource#AgeBand}",
		"LeadTraveller": true
	}],
	"TravellerMix": {
		"Adult": "${DataSource#Adult}",
		"Child": "${DataSource#Child}",
		"Youth": "${DataSource#Youth}",
		"Infant": "${DataSource#Infant}",
		"Senior": "${DataSource#Senior}",
		"Total": "${DataSource#Total}"
	},
	"SpecialRequirement": "${DataSource#SpecialRequirement}",
	"PickupPoint": "${DataSource#PickupPoint}",
	"ContactDetail": {
		"ContactType": "${DataSource#ContactType}",
		"ContactName": "${DataSource#ContactName}",
		"ContactValue": "${DataSource#ContactValue}"
	},
	"AvailabiltyHoldReference": "${DataSource#AvailabiltyHoldReference}"
}
}</con:request>
            <con:originalUri>http://bb-viator-api-v.eu.cloudhub.io/api/1/bookings</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>Inherit From Parent</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="transfer" name="Property Transfer" id="535a7aa2-4fb4-48d1-bbca-130625c6ff8b">
        <con:settings/>
        <con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>responseType</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>responseType</con:sourcePath>
            <con:targetType>responseType</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>status</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.Status[0]</con:sourcePath>
            <con:targetType>status</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:targetPath/>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>response</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath/>
            <con:targetType>response</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>failreason</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.ErrorMessage[0]</con:sourcePath>
            <con:targetType>failReason</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="SaveXmls" id="a87a46a2-3ca4-4fa7-8160-44f7a56ba40f">
        <con:settings/>
        <con:config>
          <script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def name = context.expand( '${Properties#Filename}' )
def location = context.expand( '${Properties#SaveLocation}' )
log.info(location)
def getResponseFilename(name) {
   count = ( testRunner.testCase.testSteps["DataSource"].currentRow )
   date = new Date()
   dateFormat = new java.text.SimpleDateFormat('yyyyMMdd-kkmmss')
   shortDate = dateFormat.format(date)
def testCaseID = context.expand( '${DataSource#Test Case}' )
   respFilename = shortDate + "-" + testCaseID + "-response.xml"  // implicitely returned
}

def getRequestFilename(name) {  
	def testCaseID = context.expand( '${DataSource#Test Case}' ) 
	reqFilename = shortDate + "-" + testCaseID + "-request.xml"  // implicitely returned
}
	
def file = new PrintWriter (location + getResponseFilename(name))
log.info(name)
def Response = testRunner.testCase.testSteps["Request"].testRequest.response.contentAsString
log.info(Response)
file.println(Response)
file.flush()
file.close()

def file2 = new PrintWriter (location + getRequestFilename(name))
def Request = context.expand( '${Request#Request}' )
file2.println(Request)
file2.flush()
file2.close()</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="feb8ea80-a8f5-4b06-a084-46707d178e0f">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorBooking_TestData.xlsx</file>
              <outfile>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorBooking_TestData.xlsx</outfile>
              <worksheet>Results</worksheet>
              <cell>A21</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Test Case</con:name>
              <con:value>${DataSource#Test Case}</con:value>
            </con:property>
            <con:property>
              <con:name>description</con:name>
              <con:value>${DataSource#Description (optional)}</con:value>
            </con:property>
            <con:property>
              <con:name>request</con:name>
              <con:value>${#TestSuite#RequestType}</con:value>
            </con:property>
            <con:property>
              <con:name>Test Case Status</con:name>
              <con:value>${#Project#status}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail Reason</con:name>
              <con:value>${#Project#failReason}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${#Project#response}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="47dae5a7-7905-4c61-9b82-3d40a154ed7a">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>Request</targetStep>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>0e8852e8-5b83-4071-8d45-39ca2d2abc09</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>feb8ea80-a8f5-4b06-a084-46707d178e0f</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
    </con:testCase>
    <con:testCase id="366f629e-9a29-4052-abdb-22384c92ae59" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="Booking_MM" searchProperties="true" timeout="0" maxResults="0">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="90910187-ad56-4afd-9dea-bb82b9709216">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\TestData\BigBusViatorBooking_TestData.xlsx</con:value>
            </con:property>
            <con:property>
              <con:name>SaveLocation</con:name>
              <con:value>${projectDir}\TestResults\Booking\</con:value>
            </con:property>
            <con:property>
              <con:name>TestDataSheetName</con:name>
              <con:value>MM</con:value>
            </con:property>
            <con:property>
              <con:name>Filename</con:name>
              <con:value>BigBusViatorBooking_TestData</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="562f9746-d698-41c3-848a-d815b381fdf2">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorBooking_TestData.xlsx</file>
              <worksheet>MM</worksheet>
              <cell>A7</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Test Case</con:property>
          <con:property>Description (optional)</con:property>
          <con:property>requestType</con:property>
          <con:property>ApiKey</con:property>
          <con:property>ResellerId</con:property>
          <con:property>SupplierId</con:property>
          <con:property>ExternalReference</con:property>
          <con:property>Timestamp</con:property>
          <con:property>Extension</con:property>
          <con:property>Parameter.Name</con:property>
          <con:property>Parameter.Value</con:property>
          <con:property>BookingReference</con:property>
          <con:property>TravelDate</con:property>
          <con:property>SupplierProductCode</con:property>
          <con:property>Location</con:property>
          <con:property>SupplierOptionCode</con:property>
          <con:property>SupplierOptionName</con:property>
          <con:property>TourDepartureTime</con:property>
          <con:property>TourDuration</con:property>
          <con:property>LanguageCode</con:property>
          <con:property>LanguageOption</con:property>
          <con:property>Option.Name</con:property>
          <con:property>Option.Value</con:property>
          <con:property>Inclusion</con:property>
          <con:property>CurrencyCode</con:property>
          <con:property>Amount</con:property>
          <con:property>TravellerIdentifier</con:property>
          <con:property>TravellerTitle</con:property>
          <con:property>GivenName</con:property>
          <con:property>Surname</con:property>
          <con:property>AgeBand</con:property>
          <con:property>LeadTraveller</con:property>
          <con:property>Adult</con:property>
          <con:property>Child</con:property>
          <con:property>Youth</con:property>
          <con:property>Infant</con:property>
          <con:property>Senior</con:property>
          <con:property>Total</con:property>
          <con:property>Question</con:property>
          <con:property>QuestionText</con:property>
          <con:property>QuestionAnswer</con:property>
          <con:property>SpecialRequirement</con:property>
          <con:property>PickupPoint</con:property>
          <con:property>SupplierNote</con:property>
          <con:property>Remark</con:property>
          <con:property>ContactType</con:property>
          <con:property>ContactName</con:property>
          <con:property>ContactValue</con:property>
          <con:property>AvailabiltyHoldReference</con:property>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="d7e1f8c7-575d-4f15-9663-9e58e250769b">
        <con:settings/>
        <con:config service="http://bb-viator-api-v.eu.cloudhub.io" resourcePath="/api/1/bookings" methodName="Booking" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="398b8177-7e96-4821-b532-20216c36ac53" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>${#Project#endpoint}</con:endpoint>
            <con:request>{
	"requestType": "${DataSource#requestType}",
	"data": {
		"ApiKey": "${DataSource#ApiKey}",
		"ResellerId": "${DataSource#ResellerId}",
		"SupplierId": "${DataSource#SupplierId}",
		"ExternalReference": "${DataSource#ExternalReference}",
		"Timestamp": "${DataSource#Timestamp}",
		"BookingReference": "${DataSource#BookingReference}",
		"TravelDate": "${DataSource#TravelDate}",
		"SupplierProductCode": "${DataSource#SupplierProductCode}",
		"Location": "${DataSource#Location}",
		"TourOptions": {
			"Language": {
				"LanguageCode": "${DataSource#LanguageCode}",
				"LanguageOption": "${DataSource#LanguageOption}"
			},
			"SupplierOptionCode": "${DataSource#SupplierOptionCode}",
			"TourDepartureTime": "${DataSource#TourDepartureTime}",
			"Option": [{
				"Name": "${DataSource#Option.Name}",
				"Value": "${DataSource#Option.Value}"
			}]
		},
		"Inclusions": {
			"Inclusion": "${DataSource#Inclusion}"
		},
		"CurrencyCode": "${DataSource#CurrencyCode}",
		"Amount": 100,
	"Traveller": [{
		"TravellerIdentifier": "${DataSource#TravellerIdentifier}",
		"TravellerTitle": "${DataSource#TravellerTitle}",
		"GivenName": "${DataSource#GivenName}",
		"Surname": "${DataSource#Surname}",
		"AgeBand": "${DataSource#AgeBand}",
		"LeadTraveller": true
	}],
	"TravellerMix": {
		"Adult": "${DataSource#Adult}",
		"Child": "${DataSource#Child}",
		"Youth": "${DataSource#Youth}",
		"Infant": "${DataSource#Infant}",
		"Senior": "${DataSource#Senior}",
		"Total": "${DataSource#Total}"
	},
	"SpecialRequirement": "${DataSource#SpecialRequirement}",
	"PickupPoint": "${DataSource#PickupPoint}",
	"ContactDetail": {
		"ContactType": "${DataSource#ContactType}",
		"ContactName": "${DataSource#ContactName}",
		"ContactValue": "${DataSource#ContactValue}"
	},
	"AvailabiltyHoldReference": "${DataSource#AvailabiltyHoldReference}"
}
}</con:request>
            <con:originalUri>https://bb-viator-api-d.eu.cloudhub.io/api/1/bookings</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>Inherit From Parent</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="transfer" name="Property Transfer" id="ff3c38b6-b623-401e-bda5-43ddf756d399">
        <con:settings/>
        <con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>responseType</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>responseType</con:sourcePath>
            <con:targetType>responseType</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>status</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.Status[0]</con:sourcePath>
            <con:targetType>status</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:targetPath/>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>response</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath/>
            <con:targetType>response</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>failreason</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.ErrorMessage[0]</con:sourcePath>
            <con:targetType>failReason</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="SaveXmls" id="c612eb47-39e9-4564-8ff7-5e8c20f732c0">
        <con:settings/>
        <con:config>
          <script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def name = context.expand( '${Properties#Filename}' )
def location = context.expand( '${Properties#SaveLocation}' )
log.info(location)
def getResponseFilename(name) {
   count = ( testRunner.testCase.testSteps["DataSource"].currentRow )
   date = new Date()
   dateFormat = new java.text.SimpleDateFormat('yyyyMMdd-kkmmss')
   shortDate = dateFormat.format(date)
def testCaseID = context.expand( '${DataSource#Test Case}' )
   respFilename = shortDate + "-" + testCaseID + "-response.xml"  // implicitely returned
}

def getRequestFilename(name) {  
	def testCaseID = context.expand( '${DataSource#Test Case}' ) 
	reqFilename = shortDate + "-" + testCaseID + "-request.xml"  // implicitely returned
}
	
def file = new PrintWriter (location + getResponseFilename(name))
log.info(name)
def Response = testRunner.testCase.testSteps["Request"].testRequest.response.contentAsString
log.info(Response)
file.println(Response)
file.flush()
file.close()

def file2 = new PrintWriter (location + getRequestFilename(name))
def Request = context.expand( '${Request#Request}' )
file2.println(Request)
file2.flush()
file2.close()</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="6dd1cd60-c9aa-4eb4-baba-503e4c75f903">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorBooking_TestData.xlsx</file>
              <outfile>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorBooking_TestData.xlsx</outfile>
              <worksheet>Results</worksheet>
              <cell>A8</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Test Case</con:name>
              <con:value>${DataSource#Test Case}</con:value>
            </con:property>
            <con:property>
              <con:name>description</con:name>
              <con:value>${DataSource#Description (optional)}</con:value>
            </con:property>
            <con:property>
              <con:name>request</con:name>
              <con:value>${#TestSuite#RequestType}</con:value>
            </con:property>
            <con:property>
              <con:name>Test Case Status</con:name>
              <con:value>${#Project#status}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail Reason</con:name>
              <con:value>${#Project#failReason}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${#Project#response}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="5987b1e0-8c69-495a-81ef-698aead8796b">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>Request</targetStep>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>90910187-ad56-4afd-9dea-bb82b9709216</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>6dd1cd60-c9aa-4eb4-baba-503e4c75f903</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
    </con:testCase>
    <con:testCase id="bbbe5847-1d9d-4428-b813-3fde4dd64d8d" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="Booking_ID" searchProperties="true" timeout="0" maxResults="0">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="46f1772f-05a6-495e-83e2-cb64fd13cbbb">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\TestData\BigBusViatorBooking_TestData.xlsx</con:value>
            </con:property>
            <con:property>
              <con:name>SaveLocation</con:name>
              <con:value>${projectDir}\TestResults\Booking\</con:value>
            </con:property>
            <con:property>
              <con:name>TestDataSheetName</con:name>
              <con:value>ID</con:value>
            </con:property>
            <con:property>
              <con:name>Filename</con:name>
              <con:value>BigBusViatorBooking_TestData</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="3109fb39-7835-43a4-bb30-0362903362f5">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorBooking_TestData.xlsx</file>
              <worksheet>ID</worksheet>
              <cell>A7</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Test Case</con:property>
          <con:property>Description (optional)</con:property>
          <con:property>requestType</con:property>
          <con:property>ApiKey</con:property>
          <con:property>ResellerId</con:property>
          <con:property>SupplierId</con:property>
          <con:property>ExternalReference</con:property>
          <con:property>Timestamp</con:property>
          <con:property>Extension</con:property>
          <con:property>Parameter.Name</con:property>
          <con:property>Parameter.Value</con:property>
          <con:property>BookingReference</con:property>
          <con:property>TravelDate</con:property>
          <con:property>SupplierProductCode</con:property>
          <con:property>Location</con:property>
          <con:property>SupplierOptionCode</con:property>
          <con:property>SupplierOptionName</con:property>
          <con:property>TourDepartureTime</con:property>
          <con:property>TourDuration</con:property>
          <con:property>LanguageCode</con:property>
          <con:property>LanguageOption</con:property>
          <con:property>Option.Name</con:property>
          <con:property>Option.Value</con:property>
          <con:property>Inclusion</con:property>
          <con:property>CurrencyCode</con:property>
          <con:property>Amount</con:property>
          <con:property>TravellerIdentifier</con:property>
          <con:property>TravellerTitle</con:property>
          <con:property>GivenName</con:property>
          <con:property>Surname</con:property>
          <con:property>AgeBand</con:property>
          <con:property>LeadTraveller</con:property>
          <con:property>Adult</con:property>
          <con:property>Child</con:property>
          <con:property>Youth</con:property>
          <con:property>Infant</con:property>
          <con:property>Senior</con:property>
          <con:property>Total</con:property>
          <con:property>Question</con:property>
          <con:property>QuestionText</con:property>
          <con:property>QuestionAnswer</con:property>
          <con:property>SpecialRequirement</con:property>
          <con:property>PickupPoint</con:property>
          <con:property>SupplierNote</con:property>
          <con:property>Remark</con:property>
          <con:property>ContactType</con:property>
          <con:property>ContactName</con:property>
          <con:property>ContactValue</con:property>
          <con:property>AvailabiltyHoldReference</con:property>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="3ca5de47-897c-4c29-8056-f6c1b6731b9e">
        <con:settings/>
        <con:config service="http://bb-viator-api-v.eu.cloudhub.io" resourcePath="/api/1/bookings" methodName="Booking" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="398b8177-7e96-4821-b532-20216c36ac53" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>${#Project#endpoint}</con:endpoint>
            <con:request>{
	"requestType": "${DataSource#requestType}",
	"data": {
		"ApiKey": "${DataSource#ApiKey}",
		"ResellerId": "${DataSource#ResellerId}",
		"SupplierId": "${DataSource#SupplierId}",
		"ExternalReference": "${DataSource#ExternalReference}",
		"Timestamp": "${DataSource#Timestamp}",
		"BookingReference": "${DataSource#BookingReference}",
		"TravelDate": "${DataSource#TravelDate}",
		"SupplierProductCode": "${DataSource#SupplierProductCode}",
		"Location": "${DataSource#Location}",
		"TourOptions": {
			"Language": {
				"LanguageCode": "${DataSource#LanguageCode}",
				"LanguageOption": "${DataSource#LanguageOption}"
			},
			"SupplierOptionCode": "${DataSource#SupplierOptionCode}",
			"TourDepartureTime": "${DataSource#TourDepartureTime}",
			"Option": [{
				"Name": "${DataSource#Option.Name}",
				"Value": "${DataSource#Option.Value}"
			}]
		},
		"Inclusions": {
			"Inclusion": "${DataSource#Inclusion}"
		},
		"CurrencyCode": "${DataSource#CurrencyCode}",
		"Amount": 100,
	"Traveller": [{
		"TravellerIdentifier": "${DataSource#TravellerIdentifier}",
		"TravellerTitle": "${DataSource#TravellerTitle}",
		"GivenName": "${DataSource#GivenName}",
		"Surname": "${DataSource#Surname}",
		"AgeBand": "${DataSource#AgeBand}",
		"LeadTraveller": true
	}],
	"TravellerMix": {
		"Adult": "${DataSource#Adult}",
		"Child": "${DataSource#Child}",
		"Youth": "${DataSource#Youth}",
		"Infant": "${DataSource#Infant}",
		"Senior": "${DataSource#Senior}",
		"Total": "${DataSource#Total}"
	},
	"SpecialRequirement": "${DataSource#SpecialRequirement}",
	"PickupPoint": "${DataSource#PickupPoint}",
	"ContactDetail": {
		"ContactType": "${DataSource#ContactType}",
		"ContactName": "${DataSource#ContactName}",
		"ContactValue": "${DataSource#ContactValue}"
	},
	"AvailabiltyHoldReference": "${DataSource#AvailabiltyHoldReference}"
}
}</con:request>
            <con:originalUri>https://bb-viator-api-d.eu.cloudhub.io/api/1/bookings</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>Inherit From Parent</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="transfer" name="Property Transfer" id="7b5014ac-e342-4889-804e-9c1ef2b65ba3">
        <con:settings/>
        <con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>responseType</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>responseType</con:sourcePath>
            <con:targetType>responseType</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>status</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.Status[0]</con:sourcePath>
            <con:targetType>status</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:targetPath/>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>response</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath/>
            <con:targetType>response</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>failReason</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.ErrorMessage[0]</con:sourcePath>
            <con:targetType>failReason</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="SaveXmls" id="379343de-0ca9-48f8-aef4-643ea16e5f0e">
        <con:settings/>
        <con:config>
          <script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def name = context.expand( '${Properties#Filename}' )
def location = context.expand( '${Properties#SaveLocation}' )
log.info(location)
def getResponseFilename(name) {
   count = ( testRunner.testCase.testSteps["DataSource"].currentRow )
   date = new Date()
   dateFormat = new java.text.SimpleDateFormat('yyyyMMdd-kkmmss')
   shortDate = dateFormat.format(date)
def testCaseID = context.expand( '${DataSource#Test Case}' )
   respFilename = shortDate + "-" + testCaseID + "-response.xml"  // implicitely returned
}

def getRequestFilename(name) {  
	def testCaseID = context.expand( '${DataSource#Test Case}' ) 
	reqFilename = shortDate + "-" + testCaseID + "-request.xml"  // implicitely returned
}
	
def file = new PrintWriter (location + getResponseFilename(name))
log.info(name)
def Response = testRunner.testCase.testSteps["Request"].testRequest.response.contentAsString
log.info(Response)
file.println(Response)
file.flush()
file.close()

def file2 = new PrintWriter (location + getRequestFilename(name))
def Request = context.expand( '${Request#Request}' )
file2.println(Request)
file2.flush()
file2.close()</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="ed6e9fd0-5391-48c6-9dae-aba20fa5b074">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorBooking_TestData.xlsx</file>
              <outfile>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorBooking_TestData.xlsx</outfile>
              <worksheet>Results</worksheet>
              <cell>A23</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Test Case</con:name>
              <con:value>${DataSource#Test Case}</con:value>
            </con:property>
            <con:property>
              <con:name>description</con:name>
              <con:value>${DataSource#Description (optional)}</con:value>
            </con:property>
            <con:property>
              <con:name>request</con:name>
              <con:value>${#TestSuite#RequestType}</con:value>
            </con:property>
            <con:property>
              <con:name>Test Case Status</con:name>
              <con:value>${#Project#status}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail Reason</con:name>
              <con:value>${#Project#failReason}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${#Project#response}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="6e3745c9-ab1c-4e57-9570-f186e944ee71">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>Request</targetStep>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>ed6e9fd0-5391-48c6-9dae-aba20fa5b074</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>3109fb39-7835-43a4-bb30-0362903362f5</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>46f1772f-05a6-495e-83e2-cb64fd13cbbb</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
    </con:testCase>
    <con:properties>
      <con:property>
        <con:name>RequestType</con:name>
        <con:value>BookingRequest</con:value>
      </con:property>
    </con:properties>
    <con:reportParameters/>
  </con:testSuite>
  <con:testSuite id="8786e76f-f762-4cfa-a724-f5b6967fce37" name="CancelBooking_TestSuite">
    <con:settings/>
    <con:savedRecentRuns>1</con:savedRecentRuns>
    <con:runType>SEQUENTIAL</con:runType>
    <con:testCase id="a64e03af-a632-4bdf-b4ee-ed188507952e" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="CancelBooking_BMO" searchProperties="true" timeout="0" maxResults="0">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="1c9a262e-d713-48b1-a2a1-f5f192d26e34">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\TestData\BigBusViatorCancelBooking_TestData.xlsx</con:value>
            </con:property>
            <con:property>
              <con:name>SaveLocation</con:name>
              <con:value>${projectDir}\TestResults\CancelBooking\</con:value>
            </con:property>
            <con:property>
              <con:name>TestDataSheetName</con:name>
              <con:value>BMO</con:value>
            </con:property>
            <con:property>
              <con:name>Filename</con:name>
              <con:value>BigBusViatorCancelBooking_TestData</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="63672550-02c2-45d6-aaa0-803da9e08ea2">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorCancelBooking_TestData.xlsx</file>
              <worksheet>BMO</worksheet>
              <cell>A7</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Test Case</con:property>
          <con:property>Description (optional)</con:property>
          <con:property>requestType</con:property>
          <con:property>ApiKey</con:property>
          <con:property>ResellerId</con:property>
          <con:property>SupplierId</con:property>
          <con:property>ExternalReference</con:property>
          <con:property>Timestamp</con:property>
          <con:property>Parameter.Name</con:property>
          <con:property>Parameter.Value</con:property>
          <con:property>BookingReference</con:property>
          <con:property>CancelDate</con:property>
          <con:property>Author</con:property>
          <con:property>Reason</con:property>
          <con:property>SupplierNote</con:property>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="fe96741b-2161-42fd-9eec-f48c5965120b">
        <con:settings/>
        <con:config service="http://bb-viator-api-v.eu.cloudhub.io" resourcePath="/api/1/bookings/cancel" methodName="Cancel Booking" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="398b8177-7e96-4821-b532-20216c36ac53" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>https://bb-viator-api-d.eu.cloudhub.io</con:endpoint>
            <con:request>{
  "requestType":"${DataSource#requestType}",
  "data":{
    "ApiKey":"${DataSource#ApiKey}",
    "ResellerId":"${DataSource#ResellerId}",
    "SupplierId":"${DataSource#SupplierId}",
    "ExternalReference":"${DataSource#ExternalReference}",
    "Timestamp":"${DataSource#Timestamp}",
    "Extension":{
      "any":{
        
      }
    },
    "Parameter":{
      "Name":{
        "0":" "
      },
      "Value":{
        
      }
    },
    "BookingReference":"${DataSource#BookingReference}",
    "SupplierConfirmationNumber":"${#Project#supplierConfirmation}",
    "CancelDate":"${DataSource#CancelDate}",
    "Author":"${DataSource#Author}",
    "Reason":"${DataSource#Reason}",
    "SupplierNote":"${DataSource#SupplierNote}"
  }
}</con:request>
            <con:originalUri>https://bb-viator-api-d.eu.cloudhub.io/api/1/bookings/cancel</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>Inherit From Parent</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="transfer" name="Property Transfer" id="1529c5a6-e2b8-4ac2-8223-4bf21bc0e2a1">
        <con:settings/>
        <con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>responseType</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>responseType</con:sourcePath>
            <con:targetType>responseType</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>status</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.Status[0]</con:sourcePath>
            <con:targetType>status</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:targetPath/>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>response</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath/>
            <con:targetType>response</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>failReason</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.ErrorMessage[0]</con:sourcePath>
            <con:targetType>failReason</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="SaveXmls" id="a39cc454-219b-45ae-b34a-3de70be6efdc">
        <con:settings/>
        <con:config>
          <script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def name = context.expand( '${Properties#Filename}' )
def location = context.expand( '${Properties#SaveLocation}' )
log.info(location)
def getResponseFilename(name) {
   count = ( testRunner.testCase.testSteps["DataSource"].currentRow )
   date = new Date()
   dateFormat = new java.text.SimpleDateFormat('yyyyMMdd-kkmmss')
   shortDate = dateFormat.format(date)
def testCaseID = context.expand( '${DataSource#Test Case}' )
   respFilename = shortDate + "-" + testCaseID + "-response.xml"  // implicitely returned
}

def getRequestFilename(name) {  
	def testCaseID = context.expand( '${DataSource#Test Case}' ) 
	reqFilename = shortDate + "-" + testCaseID + "-request.xml"  // implicitely returned
}
	
def file = new PrintWriter (location + getResponseFilename(name))
log.info(name)
def Response = testRunner.testCase.testSteps["Request"].testRequest.response.contentAsString
log.info(Response)
file.println(Response)
file.flush()
file.close()

def file2 = new PrintWriter (location + getRequestFilename(name))
def Request = context.expand( '${Request#Request}' )
file2.println(Request)
file2.flush()
file2.close()</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="ef1b697f-0da8-48fb-a5f0-35591777b9b7">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorCancelBooking_TestData.xlsx</file>
              <outfile>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorCancelBooking_TestData.xlsx</outfile>
              <worksheet>Results</worksheet>
              <cell>A4</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Test Case</con:name>
              <con:value>${DataSource#Test Case}</con:value>
            </con:property>
            <con:property>
              <con:name>description</con:name>
              <con:value>${DataSource#Description (optional)}</con:value>
            </con:property>
            <con:property>
              <con:name>request</con:name>
              <con:value>${#TestSuite#requestType}</con:value>
            </con:property>
            <con:property>
              <con:name>Test Case Status</con:name>
              <con:value>${#Project#status}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail Reason</con:name>
              <con:value>${#Project#failReason}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${#Project#response}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="76778dd8-e1e6-42ed-a371-29b25af816ac">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>Request</targetStep>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>a4defb16-7654-4e70-ae3f-fef404d6ce5a</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>ef1b697f-0da8-48fb-a5f0-35591777b9b7</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
    </con:testCase>
    <con:testCase id="aa1f958d-3681-4a37-95ce-d7d527d7a0bf" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="CancelBooking_MO" searchProperties="true" timeout="0" maxResults="0">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="e127ea37-f2c3-4677-8d05-62f1b4cb9aff">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\TestData\BigBusViatorCancelBooking_TestData.xlsx</con:value>
            </con:property>
            <con:property>
              <con:name>SaveLocation</con:name>
              <con:value>${projectDir}\TestResults\CancelBooking\</con:value>
            </con:property>
            <con:property>
              <con:name>TestDataSheetName</con:name>
              <con:value>MO</con:value>
            </con:property>
            <con:property>
              <con:name>Filename</con:name>
              <con:value>BigBusViatorCancelBooking_TestData</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="131dbc32-f995-487f-999b-7958e6556196">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorCancelBooking_TestData.xlsx</file>
              <worksheet>MO</worksheet>
              <cell>A7</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Test Case</con:property>
          <con:property>Description (optional)</con:property>
          <con:property>requestType</con:property>
          <con:property>ApiKey</con:property>
          <con:property>ResellerId</con:property>
          <con:property>SupplierId</con:property>
          <con:property>ExternalReference</con:property>
          <con:property>Timestamp</con:property>
          <con:property>Parameter.Name</con:property>
          <con:property>Parameter.Value</con:property>
          <con:property>BookingReference</con:property>
          <con:property>CancelDate</con:property>
          <con:property>Author</con:property>
          <con:property>Reason</con:property>
          <con:property>SupplierNote</con:property>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="f662042c-fef6-4db6-8232-6c0092f0c38c">
        <con:settings/>
        <con:config service="http://bb-viator-api-v.eu.cloudhub.io" resourcePath="/api/1/bookings/cancel" methodName="Cancel Booking" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="398b8177-7e96-4821-b532-20216c36ac53" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>${#Project#endpoint}</con:endpoint>
            <con:request>{
  "requestType":"${DataSource#requestType}",
  "data":{
    "ApiKey":"${DataSource#ApiKey}",
    "ResellerId":"${DataSource#ResellerId}",
    "SupplierId":"${DataSource#SupplierId}",
    "ExternalReference":"${DataSource#ExternalReference}",
    "Timestamp":"${DataSource#Timestamp}",
    "Extension":{
      "any":{
        
      }
    },
    "Parameter":{
      "Name":{
        "0":" "
      },
      "Value":{
        
      }
    },
    "BookingReference":"${DataSource#BookingReference}",
    "SupplierConfirmationNumber":"${#Project#supplierConfirmation}",
    "CancelDate":"${DataSource#CancelDate}",
    "Author":"${DataSource#Author}",
    "Reason":"${DataSource#Reason}",
    "SupplierNote":"${DataSource#SupplierNote}"
  }
}</con:request>
            <con:originalUri>http://bb-viator-api-v.eu.cloudhub.io/api/1/bookings/cancel</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>Inherit From Parent</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="transfer" name="Property Transfer" id="68220d3d-0101-4871-bb05-97c9ab0d21f3">
        <con:settings/>
        <con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>responseType</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>responseType</con:sourcePath>
            <con:targetType>responseType</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>status</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.Status[0]</con:sourcePath>
            <con:targetType>status</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:targetPath/>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>response</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath/>
            <con:targetType>response</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>failReason</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.ErrorMessage[0]</con:sourcePath>
            <con:targetType>failReason</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="SaveXmls" id="9a88216c-7b76-446d-8855-6b0f537f43b7">
        <con:settings/>
        <con:config>
          <script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def name = context.expand( '${Properties#Filename}' )
def location = context.expand( '${Properties#SaveLocation}' )
log.info(location)
def getResponseFilename(name) {
   count = ( testRunner.testCase.testSteps["DataSource"].currentRow )
   date = new Date()
   dateFormat = new java.text.SimpleDateFormat('yyyyMMdd-kkmmss')
   shortDate = dateFormat.format(date)
def testCaseID = context.expand( '${DataSource#Test Case}' )
   respFilename = shortDate + "-" + testCaseID + "-response.xml"  // implicitely returned
}

def getRequestFilename(name) {  
	def testCaseID = context.expand( '${DataSource#Test Case}' ) 
	reqFilename = shortDate + "-" + testCaseID + "-request.xml"  // implicitely returned
}
	
def file = new PrintWriter (location + getResponseFilename(name))
log.info(name)
def Response = testRunner.testCase.testSteps["Request"].testRequest.response.contentAsString
log.info(Response)
file.println(Response)
file.flush()
file.close()

def file2 = new PrintWriter (location + getRequestFilename(name))
def Request = context.expand( '${Request#Request}' )
file2.println(Request)
file2.flush()
file2.close()</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="2daddfce-4fb4-444a-bb13-e7a31c202784">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorCancelBooking_TestData.xlsx</file>
              <outfile>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorCancelBooking_TestData.xlsx</outfile>
              <worksheet>Results</worksheet>
              <cell>A16</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Test Case</con:name>
              <con:value>${DataSource#Test Case}</con:value>
            </con:property>
            <con:property>
              <con:name>description</con:name>
              <con:value>${DataSource#Description (optional)}</con:value>
            </con:property>
            <con:property>
              <con:name>request</con:name>
              <con:value>${#TestSuite#requestType}</con:value>
            </con:property>
            <con:property>
              <con:name>Test Case Status</con:name>
              <con:value>${#Project#status}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail Reason</con:name>
              <con:value>${#Project#failReason}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${#Project#response}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="bde0cfc2-c1bf-4b76-b012-334111a4793d">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>Request</targetStep>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>e127ea37-f2c3-4677-8d05-62f1b4cb9aff</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>2daddfce-4fb4-444a-bb13-e7a31c202784</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
    </con:testCase>
    <con:testCase id="34edd341-6f45-4968-bacd-a9dac052d3d6" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="CancelBooking_MM" searchProperties="true" timeout="0" maxResults="0">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="446056e6-a693-4bb7-9935-585e6643c092">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\TestData\BigBusViatorCancelBooking_TestData.xlsx</con:value>
            </con:property>
            <con:property>
              <con:name>SaveLocation</con:name>
              <con:value>${projectDir}\TestResults\CancelBooking\</con:value>
            </con:property>
            <con:property>
              <con:name>TestDataSheetName</con:name>
              <con:value>MM</con:value>
            </con:property>
            <con:property>
              <con:name>Filename</con:name>
              <con:value>BigBusViatorCancelBooking_TestData</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="2e5327a9-bb3a-4043-bd11-d813e29e6ed5">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorCancelBooking_TestData.xlsx</file>
              <worksheet>MM</worksheet>
              <cell>A7</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Test Case</con:property>
          <con:property>Description (optional)</con:property>
          <con:property>requestType</con:property>
          <con:property>ApiKey</con:property>
          <con:property>ResellerId</con:property>
          <con:property>SupplierId</con:property>
          <con:property>ExternalReference</con:property>
          <con:property>Timestamp</con:property>
          <con:property>Parameter.Name</con:property>
          <con:property>Parameter.Value</con:property>
          <con:property>BookingReference</con:property>
          <con:property>CancelDate</con:property>
          <con:property>Author</con:property>
          <con:property>Reason</con:property>
          <con:property>SupplierNote</con:property>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="182a8719-680f-4b83-8d94-ef9aca11e753">
        <con:settings/>
        <con:config service="http://bb-viator-api-v.eu.cloudhub.io" resourcePath="/api/1/bookings/cancel" methodName="Cancel Booking" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="398b8177-7e96-4821-b532-20216c36ac53" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>${#Project#endpoint}</con:endpoint>
            <con:request>{
  "requestType":"${DataSource#requestType}",
  "data":{
    "ApiKey":"${DataSource#ApiKey}",
    "ResellerId":"${DataSource#ResellerId}",
    "SupplierId":"${DataSource#SupplierId}",
    "ExternalReference":"${DataSource#ExternalReference}",
    "Timestamp":"${DataSource#Timestamp}",
    "Extension":{
      "any":{
        
      }
    },
    "Parameter":{
      "Name":{
        "0":" "
      },
      "Value":{
        
      }
    },
    "BookingReference":"${DataSource#BookingReference}",
    "SupplierConfirmationNumber":"${#Project#supplierConfirmation}",
    "CancelDate":"${DataSource#CancelDate}",
    "Author":"${DataSource#Author}",
    "Reason":"${DataSource#Reason}",
    "SupplierNote":"${DataSource#SupplierNote}"
  }
}</con:request>
            <con:originalUri>http://bb-viator-api-v.eu.cloudhub.io/api/1/bookings/cancel</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>Inherit From Parent</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="transfer" name="Property Transfer" id="2418d71e-c8c1-4321-bb05-ecaf03464489">
        <con:settings/>
        <con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>responseType</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>responseType</con:sourcePath>
            <con:targetType>responseType</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>status</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.Status[0]</con:sourcePath>
            <con:targetType>status</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:targetPath/>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>response</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath/>
            <con:targetType>response</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>failreason</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.ErrorMessage[0]</con:sourcePath>
            <con:targetType>failReason</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="SaveXmls" id="fcb29834-709e-4a98-86bb-55f3cbf8cc59">
        <con:settings/>
        <con:config>
          <script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def name = context.expand( '${Properties#Filename}' )
def location = context.expand( '${Properties#SaveLocation}' )
log.info(location)
def getResponseFilename(name) {
   count = ( testRunner.testCase.testSteps["DataSource"].currentRow )
   date = new Date()
   dateFormat = new java.text.SimpleDateFormat('yyyyMMdd-kkmmss')
   shortDate = dateFormat.format(date)
def testCaseID = context.expand( '${DataSource#Test Case}' )
   respFilename = shortDate + "-" + testCaseID + "-response.xml"  // implicitely returned
}

def getRequestFilename(name) {  
	def testCaseID = context.expand( '${DataSource#Test Case}' ) 
	reqFilename = shortDate + "-" + testCaseID + "-request.xml"  // implicitely returned
}
	
def file = new PrintWriter (location + getResponseFilename(name))
log.info(name)
def Response = testRunner.testCase.testSteps["Request"].testRequest.response.contentAsString
log.info(Response)
file.println(Response)
file.flush()
file.close()

def file2 = new PrintWriter (location + getRequestFilename(name))
def Request = context.expand( '${Request#Request}' )
file2.println(Request)
file2.flush()
file2.close()</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="bfeac1d7-58e4-4efa-8aca-dcd2bbbc48bf">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorCancelBooking_TestData.xlsx</file>
              <outfile>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorCancelBooking_TestData.xlsx</outfile>
              <worksheet>Results</worksheet>
              <cell>A6</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Test Case</con:name>
              <con:value>${DataSource#Test Case}</con:value>
            </con:property>
            <con:property>
              <con:name>description</con:name>
              <con:value>${DataSource#Description (optional)}</con:value>
            </con:property>
            <con:property>
              <con:name>request</con:name>
              <con:value>${#TestSuite#requestType}</con:value>
            </con:property>
            <con:property>
              <con:name>Test Case Status</con:name>
              <con:value>${#Project#status}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail Reason</con:name>
              <con:value>${#Project#failReason}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${#Project#response}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="0e75aeb8-4e71-440e-b3cd-fd536f49e161">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>Request</targetStep>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>446056e6-a693-4bb7-9935-585e6643c092</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
      <con:breakPoints>
        <con:testStepId>bfeac1d7-58e4-4efa-8aca-dcd2bbbc48bf</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
    </con:testCase>
    <con:testCase id="d4b9e62d-9441-47c0-af7b-51082d1333a7" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="false" name="CancelBooking_ID" searchProperties="true" timeout="0" maxResults="0">
      <con:settings/>
      <con:savedRecentRuns>1</con:savedRecentRuns>
      <con:testStep type="properties" name="Properties" id="01c377ef-0b9c-4cde-996a-3bab8433ab4f">
        <con:settings/>
        <con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:properties>
            <con:property>
              <con:name>Source</con:name>
              <con:value>${projectDir}\TestData\BigBusViatorCancelBooking_TestData.xlsx</con:value>
            </con:property>
            <con:property>
              <con:name>SaveLocation</con:name>
              <con:value>${projectDir}\TestResults\CancelBooking\</con:value>
            </con:property>
            <con:property>
              <con:name>TestDataSheetName</con:name>
              <con:value>ID</con:value>
            </con:property>
            <con:property>
              <con:name>Filename</con:name>
              <con:value>BigBusViatorCancelBooking_TestData</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasource" name="DataSource" id="ebc98cac-1844-4c5e-97e7-92a84a337552">
        <con:settings/>
        <con:config xsi:type="con:DataSourceStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSource type="Excel">
            <con:configuration>
              <file>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorCancelBooking_TestData.xlsx</file>
              <worksheet>ID</worksheet>
              <cell>A7</cell>
              <ignoreEmpty>true</ignoreEmpty>
              <evaluateFormulas>false</evaluateFormulas>
            </con:configuration>
          </con:dataSource>
          <con:shared>true</con:shared>
          <con:restartShared>true</con:restartShared>
          <con:property>Test Case</con:property>
          <con:property>Description (optional)</con:property>
          <con:property>requestType</con:property>
          <con:property>ApiKey</con:property>
          <con:property>ResellerId</con:property>
          <con:property>SupplierId</con:property>
          <con:property>ExternalReference</con:property>
          <con:property>Timestamp</con:property>
          <con:property>Parameter.Name</con:property>
          <con:property>Parameter.Value</con:property>
          <con:property>BookingReference</con:property>
          <con:property>CancelDate</con:property>
          <con:property>Author</con:property>
          <con:property>Reason</con:property>
          <con:property>SupplierNote</con:property>
          <con:completeLastOperation>true</con:completeLastOperation>
          <con:restartOnRun>true</con:restartOnRun>
        </con:config>
      </con:testStep>
      <con:testStep type="restrequest" name="Request" id="52531b3e-da98-4719-9bff-2756f540970e">
        <con:settings/>
        <con:config service="http://bb-viator-api-v.eu.cloudhub.io" resourcePath="/api/1/bookings/cancel" methodName="Cancel Booking" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:restRequest name="Request" id="398b8177-7e96-4821-b532-20216c36ac53" mediaType="application/json" postQueryString="false">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting>
            </con:settings>
            <con:endpoint>${#Project#endpoint}</con:endpoint>
            <con:request>{
  "requestType":"${DataSource#requestType}",
  "data":{
    "ApiKey":"${DataSource#ApiKey}",
    "ResellerId":"${DataSource#ResellerId}",
    "SupplierId":"${DataSource#SupplierId}",
    "ExternalReference":"${DataSource#ExternalReference}",
    "Timestamp":"${DataSource#Timestamp}",
    "Extension":{
      "any":{
        
      }
    },
    "Parameter":{
      "Name":{
        "0":" "
      },
      "Value":{
        
      }
    },
    "BookingReference":"${DataSource#BookingReference}",
    "SupplierConfirmationNumber":"${#Project#supplierConfirmation}",
    "CancelDate":"${DataSource#CancelDate}",
    "Author":"${DataSource#Author}",
    "Reason":"${DataSource#Reason}",
    "SupplierNote":"${DataSource#SupplierNote}"
  }
}</con:request>
            <con:originalUri>http://bb-viator-api-v.eu.cloudhub.io/api/1/bookings/cancel</con:originalUri>
            <con:credentials>
              <con:selectedAuthProfile>Inherit From Parent</con:selectedAuthProfile>
              <con:authType>No Authorization</con:authType>
            </con:credentials>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:parameters/>
            <con:parameterOrder/>
          </con:restRequest>
        </con:config>
      </con:testStep>
      <con:testStep type="transfer" name="Property Transfer" id="ca715c1d-30ec-4be5-9bd0-0679a8c38669">
        <con:settings/>
        <con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>responseType</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>responseType</con:sourcePath>
            <con:targetType>responseType</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>status</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.Status[0]</con:sourcePath>
            <con:targetType>status</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:targetPath/>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>response</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath/>
            <con:targetType>response</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
          <con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false">
            <con:name>failReason</con:name>
            <con:sourceType>Response</con:sourceType>
            <con:sourceStep>Request</con:sourceStep>
            <con:sourcePath>.ErrorMessage[0]</con:sourcePath>
            <con:targetType>failReason</con:targetType>
            <con:targetStep>#Project#</con:targetStep>
            <con:type>JSONPATH</con:type>
            <con:targetTransferType>JSONPATH</con:targetTransferType>
            <con:upgraded>true</con:upgraded>
          </con:transfers>
        </con:config>
      </con:testStep>
      <con:testStep type="groovy" name="SaveXmls" id="99d63e01-5c23-42a5-85da-668147095774">
        <con:settings/>
        <con:config>
          <script>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def name = context.expand( '${Properties#Filename}' )
def location = context.expand( '${Properties#SaveLocation}' )
log.info(location)
def getResponseFilename(name) {
   count = ( testRunner.testCase.testSteps["DataSource"].currentRow )
   date = new Date()
   dateFormat = new java.text.SimpleDateFormat('yyyyMMdd-kkmmss')
   shortDate = dateFormat.format(date)
def testCaseID = context.expand( '${DataSource#Test Case}' )
   respFilename = shortDate + "-" + testCaseID + "-response.xml"  // implicitely returned
}

def getRequestFilename(name) {  
	def testCaseID = context.expand( '${DataSource#Test Case}' ) 
	reqFilename = shortDate + "-" + testCaseID + "-request.xml"  // implicitely returned
}
	
def file = new PrintWriter (location + getResponseFilename(name))
log.info(name)
def Response = testRunner.testCase.testSteps["Request"].testRequest.response.contentAsString
log.info(Response)
file.println(Response)
file.flush()
file.close()

def file2 = new PrintWriter (location + getRequestFilename(name))
def Request = context.expand( '${Request#Request}' )
file2.println(Request)
file2.flush()
file2.close()</script>
        </con:config>
      </con:testStep>
      <con:testStep type="datasink" name="DataSink" id="94a90721-d640-4984-8dc2-b78006dd2c80">
        <con:settings/>
        <con:config xsi:type="con:DataSinkStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
          <con:dataSink type="Excel">
            <con:configuration>
              <file>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorCancelBooking_TestData.xlsx</file>
              <outfile>D:/Vimala@625/Projects/BigBus/Viator/Testing/TestSuites/TestData/BigBusViatorCancelBooking_TestData.xlsx</outfile>
              <worksheet>Results</worksheet>
              <cell>A18</cell>
              <evaluateFormulas>false</evaluateFormulas>
              <append>false</append>
            </con:configuration>
          </con:dataSink>
          <con:properties>
            <con:property>
              <con:name>Test Case</con:name>
              <con:value>${DataSource#Test Case}</con:value>
            </con:property>
            <con:property>
              <con:name>description</con:name>
              <con:value>${DataSource#Description (optional)}</con:value>
            </con:property>
            <con:property>
              <con:name>request</con:name>
              <con:value>${#TestSuite#requestType}</con:value>
            </con:property>
            <con:property>
              <con:name>Test Case Status</con:name>
              <con:value>${#Project#status}</con:value>
            </con:property>
            <con:property>
              <con:name>Fail Reason</con:name>
              <con:value>${#Project#failReason}</con:value>
            </con:property>
            <con:property>
              <con:name>Response</con:name>
              <con:value>${#Project#response}</con:value>
            </con:property>
          </con:properties>
        </con:config>
      </con:testStep>
      <con:testStep type="datasourceloop" name="DataSource Loop" id="54313405-99fc-42c7-a62a-7bd5237aa6eb">
        <con:settings/>
        <con:config>
          <dataSourceStep>DataSource</dataSourceStep>
          <targetStep>Request</targetStep>
        </con:config>
      </con:testStep>
      <con:properties/>
      <con:reportParameters/>
      <con:breakPoints>
        <con:testStepId>94a90721-d640-4984-8dc2-b78006dd2c80</con:testStepId>
        <con:status>NONE</con:status>
        <con:properties/>
      </con:breakPoints>
    </con:testCase>
    <con:properties>
      <con:property>
        <con:name>requestType</con:name>
        <con:value>cancelBookingRequest</con:value>
      </con:property>
    </con:properties>
    <con:reportParameters/>
  </con:testSuite>
  <con:savedRecentRuns>1</con:savedRecentRuns>
  <con:endpointStrategy xsi:type="con:DefaultEndpointStrategy" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:endpoint mode="OVERRIDE">https://bb-web-api-g.eu.cloudhub.io</con:endpoint>
  </con:endpointStrategy>
  <con:requirements/>
  <con:properties>
    <con:property>
      <con:name>failReason</con:name>
      <con:value>[]</con:value>
    </con:property>
    <con:property>
      <con:name>status</con:name>
      <con:value>[SUCCESS]</con:value>
    </con:property>
    <con:property>
      <con:name>response</con:name>
      <con:value>{"responseType":"TourListResponse","data":{"ApiKey":"8b^gf=lbs5ASA4VZmH2NzgDMS^$s@HgBFeIcO1zY=oi","ResellerId":"1000","SupplierId":"1004","ExternalReference":"10051374722994000","Timestamp":"2018-02-15 11:30:54","RequestStatus":{"Status":"SUCCESS"},"Tour":[{"SupplierProductCode":"154565","SupplierProductName":"Premium Tour CHICAGO","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"154564","SupplierProductName":"Classic Tour CHICAGO","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"154655","SupplierProductName":"Deluxe Tour CHICAGO","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"54493","SupplierProductName":"Classic Tour SAN FRANCISCO","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"54495","SupplierProductName":"Deluxe Tour SAN FRANCISCO","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"54496","SupplierProductName":"Night Tour SAN FRANCISCO","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"54494","SupplierProductName":"Premium Tour SAN FRANCISCO","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"74505","SupplierProductName":"Deluxe Tour LAS VEGAS","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"74506","SupplierProductName":"Night Tour LAS VEGAS","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"74503","SupplierProductName":"Classic Tour LAS VEGAS","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"74504","SupplierProductName":"Premium Tour LAS VEGAS","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"24659","SupplierProductName":"Night Tour NEW YORK","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"24490","SupplierProductName":"Classic Tour NEW YORK","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"24511","SupplierProductName":"Deluxe Tour NEW YORK","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"24491","SupplierProductName":"Premium Tour NEW YORK","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"44569","SupplierProductName":"Panoramic Night Tour WASHINGTON DC","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"44567","SupplierProductName":"Premium Tour WASHINGTON DC","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"44568","SupplierProductName":"Deluxe Tour WASHINGTON DC","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"64657","SupplierProductName":"Deluxe Tour MIAMI","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"64658","SupplierProductName":"Night Tour MIAMI","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"64570","SupplierProductName":"Classic Tour MIAMI","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"64571","SupplierProductName":"Premium Tour MIAMI","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"164498","SupplierProductName":"Premium Tour ROME","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"164497","SupplierProductName":"Classic Tour ROME","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"164499","SupplierProductName":"Deluxe Tour ROME","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"34664","SupplierProductName":"Deluxe Tour PARIS","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"34665","SupplierProductName":"Night Tour PARIS","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"34500","SupplierProductName":"Classic Tour PARIS","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"34501","SupplierProductName":"Premium Tour PARIS","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"84572","SupplierProductName":"Classic Tour VIENNA","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"84661","SupplierProductName":"Deluxe Tour VIENNA","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"84663","SupplierProductName":"Night Tour VIENNA","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"84573","SupplierProductName":"Premium Tour VIENNA","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"94897","SupplierProductName":"Night Tour BUDAPEST","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"94866","SupplierProductName":"Deluxe Tour BUDAPEST","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"94865","SupplierProductName":"Premium Tour BUDAPEST","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"94864","SupplierProductName":"Classic Tour BUDAPEST","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"114559","SupplierProductName":"Night Tour DUBAI","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"114556","SupplierProductName":"Classic Tour DUBAI","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"114557","SupplierProductName":"Premium Tour DUBAI","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"114558","SupplierProductName":"Deluxe Tour DUBAI","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"124562","SupplierProductName":"Premium Tour ABU DHABI","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"124666","SupplierProductName":"Deluxe Tour ABU DHABI","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"124667","SupplierProductName":"Night Tour ABU DHABI","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"124560","SupplierProductName":"Classic Tour ABU DHABI","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"14489","SupplierProductName":"Premium Tour LONDON","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"14488","SupplierProductName":"Classic Tour LONDON","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"14660","SupplierProductName":"Deluxe Tour LONDON","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"14751","SupplierProductName":" Night Tour LONDON","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"134750","SupplierProductName":"Night Tour HONG KONG","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"134508","SupplierProductName":"Premium Tour HONG KONG","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"134697","SupplierProductName":"Deluxe Tour HONG KONG","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"134507","SupplierProductName":"Classic Tour HONG KONG","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"194595","SupplierProductName":"Deluxe Tour SYDNEY","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"194593","SupplierProductName":"Classic Tour SYDNEY","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]},{"SupplierProductCode":"194594","SupplierProductName":"Premium Tour SYDNEY","CountryCode":"GB","DestinationCode":"LON","DestinationName":"LONDON","TourDescription":"","TourOption":[]}]}}</con:value>
    </con:property>
    <con:property>
      <con:name>responseType</con:name>
      <con:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">TourListResponse</con:value>
    </con:property>
    <con:property>
      <con:name>supplierConfirmation</con:name>
      <con:value xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
    </con:property>
    <con:property>
      <con:name>endpoint</con:name>
      <con:value>https://bb-viator-api-t.eu.cloudhub.io</con:value>
    </con:property>
  </con:properties>
  <con:wssContainer/>
  <con:databaseConnectionContainer/>
  <con:jmsConnectionContainer/>
  <con:oAuth2ProfileContainer/>
  <con:oAuth1ProfileContainer/>
  <con:reporting>
    <con:xmlTemplates/>
    <con:parameters/>
  </con:reporting>
  <con:authRepository/>
  <con:tags/>
</con:soapui-project>
